[{"kind": "Listing", "data": {"modhash": "", "children": [{"kind": "t3", "data": {"contest_mode": false, "banned_by": null, "media_embed": {}, "subreddit": "networking", "selftext_html": "&lt;!-- SC_OFF --&gt;&lt;div class=\"md\"&gt;&lt;p&gt;We have a customer (fire district) that has a 5 site CenturyLink Metro-E network. The fire district gets their dispatching and radio services from the main municipality of our metro area. The municipality is implementing a new radio network and wants to piggy back on the Metro-E between two of the stations. They will need 4 VLANS for their equipment between the two sites. We also want to limit their equipment to no more than 10Mbps of the 50Mbps circuit.  &lt;/p&gt;\n\n&lt;p&gt;&amp;nbsp;&lt;/p&gt;\n\n&lt;p&gt;Currently the MoE circuits plug directly into the Sonicwalls:  &lt;/p&gt;\n\n&lt;p&gt;&lt;a href=\"http://imgur.com/a/2XVlU\"&gt;http://imgur.com/a/2XVlU&lt;/a&gt;  &lt;/p&gt;\n\n&lt;p&gt;The municipality is recommending we insert a switch between the Sonicwall and the MoE device and run QinQ, like this:  &lt;/p&gt;\n\n&lt;p&gt;&lt;a href=\"http://imgur.com/a/UK2ra\"&gt;http://imgur.com/a/UK2ra&lt;/a&gt;  &lt;/p&gt;\n\n&lt;p&gt;&amp;nbsp;&lt;/p&gt;\n\n&lt;p&gt;QinQ is a new concept to me, so I am still trying to wrap my head around how this works. From what I understand I will need to call CenturyLink and have them enable it, and they will give me a VLAN number to use. I will then configure the switch to tunnel the 4 VLANS for the new radio equipment within that CTL provided VLAN. &lt;/p&gt;\n\n&lt;p&gt;&amp;nbsp; &lt;/p&gt;\n\n&lt;ol&gt;\n&lt;li&gt;Is QinQ the best method of accomplishing this?&lt;br/&gt;&lt;/li&gt;\n&lt;li&gt;What switch would you guys recommend for this? The municipality is recommending a Brocade ICX7450-24. It looks like these things run ~$2000? Seems kind of steep for what we need to accomplish. There is grant money available for this project (which is how it&amp;#39;s even happening at all), but I still don&amp;#39;t want to have them spend unnecessarily.&lt;br/&gt;&lt;/li&gt;\n&lt;li&gt;Once the MoE switchport is configured for QinQ, do you still configure a native VLAN on that port? If so, do I then just configure the switchport connecting to the Sonicwall as an access port on the native VLAN of the QinQ port and all my traffic will flow over that? Or do I then need to make the Sonicwalls switchport a regular trunk and include those VLANS in the QinQ tunnel?&lt;br/&gt;&lt;/li&gt;\n&lt;/ol&gt;\n&lt;/div&gt;&lt;!-- SC_ON --&gt;", "selftext": "We have a customer (fire district) that has a 5 site CenturyLink Metro-E network. The fire district gets their dispatching and radio services from the main municipality of our metro area. The municipality is implementing a new radio network and wants to piggy back on the Metro-E between two of the stations. They will need 4 VLANS for their equipment between the two sites. We also want to limit their equipment to no more than 10Mbps of the 50Mbps circuit.  \n\n&amp;nbsp;\n\nCurrently the MoE circuits plug directly into the Sonicwalls:  \n\nhttp://imgur.com/a/2XVlU  \n\nThe municipality is recommending we insert a switch between the Sonicwall and the MoE device and run QinQ, like this:  \n\nhttp://imgur.com/a/UK2ra  \n\n&amp;nbsp;\n\nQinQ is a new concept to me, so I am still trying to wrap my head around how this works. From what I understand I will need to call CenturyLink and have them enable it, and they will give me a VLAN number to use. I will then configure the switch to tunnel the 4 VLANS for the new radio equipment within that CTL provided VLAN. \n\n&amp;nbsp; \n\n1. Is QinQ the best method of accomplishing this?  \n2. What switch would you guys recommend for this? The municipality is recommending a Brocade ICX7450-24. It looks like these things run ~$2000? Seems kind of steep for what we need to accomplish. There is grant money available for this project (which is how it's even happening at all), but I still don't want to have them spend unnecessarily.  \n3. Once the MoE switchport is configured for QinQ, do you still configure a native VLAN on that port? If so, do I then just configure the switchport connecting to the Sonicwall as an access port on the native VLAN of the QinQ port and all my traffic will flow over that? Or do I then need to make the Sonicwalls switchport a regular trunk and include those VLANS in the QinQ tunnel?  \n\n", "likes": null, "suggested_sort": null, "user_reports": [], "secure_media": null, "link_flair_text": null, "id": "656nap", "gilded": 0, "secure_media_embed": {}, "clicked": false, "score": 6, "report_reasons": null, "author": "NoWorriez", "saved": false, "mod_reports": [], "name": "t3_656nap", "subreddit_name_prefixed": "r/networking", "approved_by": null, "over_18": false, "domain": "self.networking", "hidden": false, "thumbnail": "", "subreddit_id": "t5_2qkaf", "edited": false, "link_flair_css_class": null, "author_flair_css_class": null, "downs": 0, "brand_safe": true, "archived": false, "removal_reason": null, "is_self": true, "hide_score": false, "spoiler": false, "permalink": "/r/networking/comments/656nap/looking_for_some_guidance_with_qinq_over_some/", "num_reports": null, "locked": false, "stickied": false, "created": 1492130625.0, "url": "https://www.reddit.com/r/networking/comments/656nap/looking_for_some_guidance_with_qinq_over_some/", "author_flair_text": null, "quarantine": false, "title": "Looking for some guidance with QinQ over some Metro-E circuits", "created_utc": 1492101825.0, "distinguished": null, "media": null, "upvote_ratio": 0.88, "num_comments": 9, "visited": false, "subreddit_type": "public", "ups": 6}}], "after": null, "before": null}}, {"kind": "Listing", "data": {"modhash": "", "children": [{"kind": "t1", "data": {"subreddit_id": "t5_2qkaf", "removal_reason": null, "link_id": "t3_656nap", "likes": null, "replies": {"kind": "Listing", "data": {"modhash": "", "children": [{"kind": "t1", "data": {"subreddit_id": "t5_2qkaf", "removal_reason": null, "link_id": "t3_656nap", "likes": null, "replies": "", "user_reports": [], "id": "dg7zjx0", "gilded": 0, "archived": false, "score": 2, "report_reasons": null, "author": "VictimOfAReload", "parent_id": "t1_dg7y33r", "subreddit_name_prefixed": "r/networking", "controversiality": 0, "body": "+1 for this.\n\nA lot of times providers and their users will call this QinQ. This is because sometimes the provider is providing the \"Metro-E\" as a VLAN on their own Layer 2 network. So as /u/fgor pointed it. To THEM it would be QinQ. To you, it's just single VLAN's on a trunk port..etc.", "edited": false, "downs": 0, "body_html": "&lt;div class=\"md\"&gt;&lt;p&gt;+1 for this.&lt;/p&gt;\n\n&lt;p&gt;A lot of times providers and their users will call this QinQ. This is because sometimes the provider is providing the &amp;quot;Metro-E&amp;quot; as a VLAN on their own Layer 2 network. So as &lt;a href=\"/u/fgor\"&gt;/u/fgor&lt;/a&gt; pointed it. To THEM it would be QinQ. To you, it&amp;#39;s just single VLAN&amp;#39;s on a trunk port..etc.&lt;/p&gt;\n&lt;/div&gt;", "subreddit": "networking", "name": "t1_dg7zjx0", "score_hidden": false, "stickied": false, "created": 1492136887.0, "created_utc": 1492108087.0, "depth": 1, "mod_reports": [], "subreddit_type": "public", "ups": 2}}, {"kind": "t1", "data": {"subreddit_id": "t5_2qkaf", "removal_reason": null, "link_id": "t3_656nap", "likes": null, "replies": {"kind": "Listing", "data": {"modhash": "", "children": [{"kind": "t1", "data": {"subreddit_id": "t5_2qkaf", "removal_reason": null, "link_id": "t3_656nap", "likes": null, "replies": "", "user_reports": [], "id": "dg89pid", "gilded": 0, "archived": false, "score": 2, "report_reasons": null, "author": "error404", "parent_id": "t1_dg7zt7j", "subreddit_name_prefixed": "r/networking", "controversiality": 0, "body": "They probably just want to avoid having to coordinate their VLAN IDs with you.", "edited": false, "downs": 0, "body_html": "&lt;div class=\"md\"&gt;&lt;p&gt;They probably just want to avoid having to coordinate their VLAN IDs with you.&lt;/p&gt;\n&lt;/div&gt;", "subreddit": "networking", "name": "t1_dg89pid", "score_hidden": false, "stickied": false, "created": 1492148235.0, "created_utc": 1492119435.0, "depth": 2, "mod_reports": [], "subreddit_type": "public", "ups": 2}}], "after": null, "before": null}}, "user_reports": [], "id": "dg7zt7j", "gilded": 0, "archived": false, "score": 2, "report_reasons": null, "author": "NoWorriez", "parent_id": "t1_dg7y33r", "subreddit_name_prefixed": "r/networking", "controversiality": 0, "body": "That was actually my initial thought as well, if this is supposedly a transparent L2 service between the sites, why can't we just configure the switchport connected to the MoE device as a regular old trunk port on each side. My only guess is the municipality knows what you can and can't do with this particular service (they work with it a lot), that's why they are recommending the QinQ.", "edited": false, "downs": 0, "body_html": "&lt;div class=\"md\"&gt;&lt;p&gt;That was actually my initial thought as well, if this is supposedly a transparent L2 service between the sites, why can&amp;#39;t we just configure the switchport connected to the MoE device as a regular old trunk port on each side. My only guess is the municipality knows what you can and can&amp;#39;t do with this particular service (they work with it a lot), that&amp;#39;s why they are recommending the QinQ.&lt;/p&gt;\n&lt;/div&gt;", "subreddit": "networking", "name": "t1_dg7zt7j", "score_hidden": false, "stickied": false, "created": 1492137161.0, "created_utc": 1492108361.0, "depth": 1, "mod_reports": [], "subreddit_type": "public", "ups": 2}}], "after": null, "before": null}}, "user_reports": [], "id": "dg7y33r", "gilded": 0, "archived": false, "score": 3, "report_reasons": null, "author": "fgor", "parent_id": "t3_656nap", "subreddit_name_prefixed": "r/networking", "controversiality": 0, "body": "I think just just need one Q (ha ha) not QinQ. Plug in the switches and set up the 4 vlans for the new use + the existing native vlan.\n\nCenturylink would be the one running QinQ if needed; you need to verify with them that they will pass your (single) vlan tag. Or you can just try it and then ask them if it doesn't work; it probably will.", "edited": false, "downs": 0, "body_html": "&lt;div class=\"md\"&gt;&lt;p&gt;I think just just need one Q (ha ha) not QinQ. Plug in the switches and set up the 4 vlans for the new use + the existing native vlan.&lt;/p&gt;\n\n&lt;p&gt;Centurylink would be the one running QinQ if needed; you need to verify with them that they will pass your (single) vlan tag. Or you can just try it and then ask them if it doesn&amp;#39;t work; it probably will.&lt;/p&gt;\n&lt;/div&gt;", "subreddit": "networking", "name": "t1_dg7y33r", "score_hidden": false, "stickied": false, "created": 1492135331.0, "created_utc": 1492106531.0, "depth": 0, "mod_reports": [], "subreddit_type": "public", "ups": 3}}, {"kind": "t1", "data": {"subreddit_id": "t5_2qkaf", "removal_reason": null, "link_id": "t3_656nap", "likes": null, "replies": {"kind": "Listing", "data": {"modhash": "", "children": [{"kind": "t1", "data": {"subreddit_id": "t5_2qkaf", "removal_reason": null, "link_id": "t3_656nap", "likes": null, "replies": "", "user_reports": [], "id": "dg87qbi", "gilded": 0, "archived": false, "score": 2, "report_reasons": null, "author": "microseconds", "parent_id": "t1_dg7zml6", "subreddit_name_prefixed": "r/networking", "controversiality": 0, "body": "Be careful with the 2300 in Metro scenarios..  Seems fine here, but the 2300's don't do G.8032 at all.  It's not in the ASIC.", "edited": false, "downs": 0, "body_html": "&lt;div class=\"md\"&gt;&lt;p&gt;Be careful with the 2300 in Metro scenarios..  Seems fine here, but the 2300&amp;#39;s don&amp;#39;t do G.8032 at all.  It&amp;#39;s not in the ASIC.&lt;/p&gt;\n&lt;/div&gt;", "subreddit": "networking", "name": "t1_dg87qbi", "score_hidden": false, "stickied": false, "created": 1492145859.0, "created_utc": 1492117059.0, "depth": 1, "mod_reports": [], "subreddit_type": "public", "ups": 2}}], "after": null, "before": null}}, "user_reports": [], "id": "dg7zml6", "gilded": 0, "archived": false, "score": 2, "report_reasons": null, "author": "error404", "parent_id": "t3_656nap", "subreddit_name_prefixed": "r/networking", "controversiality": 0, "body": "&gt; Is QinQ the best method of accomplishing this?\n\nBest is subjective. It is *one* way of accomplishing this. It is *probably* the simplest and cheapest way that's not janky AF. *I* would try to take the plunge into MPLS.\n\n&gt; What switch would you guys recommend for this? The municipality is recommending a Brocade ICX7450-24. It looks like these things run ~$2000? Seems kind of steep for what we need to accomplish. There is grant money available for this project (which is how it's even happening at all), but I still don't want to have them spend unnecessarily.\n\nYou probably want something with ingress and egress two-rate, three-colour policing, so you can meet your bandwidth requirements properly, though egress policing is quite rare in low-end switches, it's more of a service provider feature. I'm most familiar with Juniper, and the cheapest device they have that I know of with this is the ACX1100, which is pretty ideal for this, but is going to be much more expensive. You might get away with egress rate shaping though instead, which almost all switches will have. If that's all you need (again, Juniper guy here) something small like EX2300-C-12T should suit. I don't believe Cisco supports it at all in their non-Metro, non-core switching.\n\n&gt; Once the MoE switchport is configured for QinQ, do you still configure a native VLAN on that port? If so, do I then just configure the switchport connecting to the Sonicwall as an access port on the native VLAN of the QinQ port and all my traffic will flow over that? Or do I then need to make the Sonicwalls switchport a regular trunk and include those VLANS in the QinQ tunnel?\n\nThe switchport on the MetroE side will be a trunk. The ports going to the SonicWall and vendor devices will each be access ports in different VLANs (which are the S-VLANs). Those devices can either tag their traffic (with a C-Tag) into the access port, which results in the switch adding a second tag to the stack (which is popped off by the switch on the other end, and a single-tagged frame comes out), or they can send untagged traffic and it will come out the access port on the other end untagged.\n\nBefore you try any of this, make sure your carrier has VLAN transparency enabled for you. It's fairly likely they need to enable this on their side.\n\nFinally, keep in mind that in an E-LAN topology, as you appear to have, it's not going to be possible to limit the bandwidth they are using at any individual site without involving your provider to set up new classes/EVCs. This because if you limit each of 4 sites to 10mbit, they can still generate 40mbit of traffic to site 5 and you can't do anything about that. You can rate limit it at ingress, of course, but this doesn't save the 30mbits of over-profile traffic from crossing the WAN at site 5.", "edited": 1492109034.0, "downs": 0, "body_html": "&lt;div class=\"md\"&gt;&lt;blockquote&gt;\n&lt;p&gt;Is QinQ the best method of accomplishing this?&lt;/p&gt;\n&lt;/blockquote&gt;\n\n&lt;p&gt;Best is subjective. It is &lt;em&gt;one&lt;/em&gt; way of accomplishing this. It is &lt;em&gt;probably&lt;/em&gt; the simplest and cheapest way that&amp;#39;s not janky AF. &lt;em&gt;I&lt;/em&gt; would try to take the plunge into MPLS.&lt;/p&gt;\n\n&lt;blockquote&gt;\n&lt;p&gt;What switch would you guys recommend for this? The municipality is recommending a Brocade ICX7450-24. It looks like these things run ~$2000? Seems kind of steep for what we need to accomplish. There is grant money available for this project (which is how it&amp;#39;s even happening at all), but I still don&amp;#39;t want to have them spend unnecessarily.&lt;/p&gt;\n&lt;/blockquote&gt;\n\n&lt;p&gt;You probably want something with ingress and egress two-rate, three-colour policing, so you can meet your bandwidth requirements properly, though egress policing is quite rare in low-end switches, it&amp;#39;s more of a service provider feature. I&amp;#39;m most familiar with Juniper, and the cheapest device they have that I know of with this is the ACX1100, which is pretty ideal for this, but is going to be much more expensive. You might get away with egress rate shaping though instead, which almost all switches will have. If that&amp;#39;s all you need (again, Juniper guy here) something small like EX2300-C-12T should suit. I don&amp;#39;t believe Cisco supports it at all in their non-Metro, non-core switching.&lt;/p&gt;\n\n&lt;blockquote&gt;\n&lt;p&gt;Once the MoE switchport is configured for QinQ, do you still configure a native VLAN on that port? If so, do I then just configure the switchport connecting to the Sonicwall as an access port on the native VLAN of the QinQ port and all my traffic will flow over that? Or do I then need to make the Sonicwalls switchport a regular trunk and include those VLANS in the QinQ tunnel?&lt;/p&gt;\n&lt;/blockquote&gt;\n\n&lt;p&gt;The switchport on the MetroE side will be a trunk. The ports going to the SonicWall and vendor devices will each be access ports in different VLANs (which are the S-VLANs). Those devices can either tag their traffic (with a C-Tag) into the access port, which results in the switch adding a second tag to the stack (which is popped off by the switch on the other end, and a single-tagged frame comes out), or they can send untagged traffic and it will come out the access port on the other end untagged.&lt;/p&gt;\n\n&lt;p&gt;Before you try any of this, make sure your carrier has VLAN transparency enabled for you. It&amp;#39;s fairly likely they need to enable this on their side.&lt;/p&gt;\n\n&lt;p&gt;Finally, keep in mind that in an E-LAN topology, as you appear to have, it&amp;#39;s not going to be possible to limit the bandwidth they are using at any individual site without involving your provider to set up new classes/EVCs. This because if you limit each of 4 sites to 10mbit, they can still generate 40mbit of traffic to site 5 and you can&amp;#39;t do anything about that. You can rate limit it at ingress, of course, but this doesn&amp;#39;t save the 30mbits of over-profile traffic from crossing the WAN at site 5.&lt;/p&gt;\n&lt;/div&gt;", "subreddit": "networking", "name": "t1_dg7zml6", "score_hidden": false, "stickied": false, "created": 1492136966.0, "created_utc": 1492108166.0, "depth": 0, "mod_reports": [], "subreddit_type": "public", "ups": 2}}, {"kind": "t1", "data": {"subreddit_id": "t5_2qkaf", "removal_reason": null, "link_id": "t3_656nap", "likes": null, "replies": {"kind": "Listing", "data": {"modhash": "", "children": [{"kind": "t1", "data": {"subreddit_id": "t5_2qkaf", "removal_reason": null, "link_id": "t3_656nap", "likes": null, "replies": "", "user_reports": [], "id": "dg7zhm3", "gilded": 0, "archived": false, "score": 1, "report_reasons": null, "author": "NoWorriez", "parent_id": "t1_dg7wwaa", "subreddit_name_prefixed": "r/networking", "controversiality": 0, "body": "I asked them initially if it could just be routed and they said no. In fact we already do just that for them for the dispatching portion (that is the second interface on the Sonicwalls, the x4.50). I don't know enough about this (especially about any of their radio gear and how it works) to argue against it. I understand that extending the L2 across the Metro-E is not recommended, but if the switchport they are uplinked to is throttled to no more than 1/5 of the circuit speed and they are running on their own VLANs, I don't see how it could harm our regular LAN to LAN traffic in any way.", "edited": 1492108453.0, "downs": 0, "body_html": "&lt;div class=\"md\"&gt;&lt;p&gt;I asked them initially if it could just be routed and they said no. In fact we already do just that for them for the dispatching portion (that is the second interface on the Sonicwalls, the x4.50). I don&amp;#39;t know enough about this (especially about any of their radio gear and how it works) to argue against it. I understand that extending the L2 across the Metro-E is not recommended, but if the switchport they are uplinked to is throttled to no more than 1/5 of the circuit speed and they are running on their own VLANs, I don&amp;#39;t see how it could harm our regular LAN to LAN traffic in any way.&lt;/p&gt;\n&lt;/div&gt;", "subreddit": "networking", "name": "t1_dg7zhm3", "score_hidden": false, "stickied": false, "created": 1492136821.0, "created_utc": 1492108021.0, "depth": 1, "mod_reports": [], "subreddit_type": "public", "ups": 1}}], "after": null, "before": null}}, "user_reports": [], "id": "dg7wwaa", "gilded": 0, "archived": false, "score": 1, "report_reasons": null, "author": "kcornet", "parent_id": "t3_656nap", "subreddit_name_prefixed": "r/networking", "controversiality": 0, "body": "I'm not sure I understand. QinQ extends the layer 2 VLANs across the datacenters. Does the new equipment require that it all be configured on the same subnet? If not, why not just put it on their respective LANs?\n\nCan the SonicWalls do L2TP?", "edited": false, "downs": 0, "body_html": "&lt;div class=\"md\"&gt;&lt;p&gt;I&amp;#39;m not sure I understand. QinQ extends the layer 2 VLANs across the datacenters. Does the new equipment require that it all be configured on the same subnet? If not, why not just put it on their respective LANs?&lt;/p&gt;\n\n&lt;p&gt;Can the SonicWalls do L2TP?&lt;/p&gt;\n&lt;/div&gt;", "subreddit": "networking", "name": "t1_dg7wwaa", "score_hidden": false, "stickied": false, "created": 1492134072.0, "created_utc": 1492105272.0, "depth": 0, "mod_reports": [], "subreddit_type": "public", "ups": 1}}, {"kind": "t1", "data": {"subreddit_id": "t5_2qkaf", "removal_reason": null, "link_id": "t3_656nap", "likes": null, "replies": "", "user_reports": [], "id": "dgbn3of", "gilded": 0, "archived": false, "score": 1, "report_reasons": null, "author": "ugmoe2000", "parent_id": "t3_656nap", "subreddit_name_prefixed": "r/networking", "controversiality": 0, "body": "For a 50 Mbps circuit I would just use a Linux server on the edge to tag the 4 VLANs. You could also shape and add other queueing if you wanted. $300 for a tidy little x86 edge box with a few Ethernet ports.", "edited": false, "downs": 0, "body_html": "&lt;div class=\"md\"&gt;&lt;p&gt;For a 50 Mbps circuit I would just use a Linux server on the edge to tag the 4 VLANs. You could also shape and add other queueing if you wanted. $300 for a tidy little x86 edge box with a few Ethernet ports.&lt;/p&gt;\n&lt;/div&gt;", "subreddit": "networking", "name": "t1_dgbn3of", "score_hidden": false, "stickied": false, "created": 1492343382.0, "created_utc": 1492314582.0, "depth": 0, "mod_reports": [], "subreddit_type": "public", "ups": 1}}], "after": null, "before": null}}]