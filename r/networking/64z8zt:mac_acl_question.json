[{"kind": "Listing", "data": {"modhash": "", "children": [{"kind": "t3", "data": {"contest_mode": false, "banned_by": null, "media_embed": {}, "subreddit": "networking", "selftext_html": "&lt;!-- SC_OFF --&gt;&lt;div class=\"md\"&gt;&lt;p&gt;I have an ugly scenario (details can be included if needed..) that I&amp;#39;m using a MAC ACL to &amp;quot;clean up.&amp;quot;  &lt;/p&gt;\n\n&lt;p&gt;I&amp;#39;m trying to create a MAC ACL that blocks ARP &lt;em&gt;responses&lt;/em&gt; but allows ARP requests.&lt;/p&gt;\n\n&lt;p&gt;What I have so far.. &lt;/p&gt;\n\n&lt;pre&gt;&lt;code&gt; permit host aaaa.bbbb.cccc host ffff.ffff.ffff 0x806 0x0\n deny host aaaa.bbbb.cccc any 0x806 0x0\n permit any any\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;My thoughts are ffff.ffff.ffff (broadcasts) would be arp requests...which would be allowed.  I then have the second line to block any other arp traffic (primarily arp responses).&lt;/p&gt;\n&lt;/div&gt;&lt;!-- SC_ON --&gt;", "selftext": "I have an ugly scenario (details can be included if needed..) that I'm using a MAC ACL to \"clean up.\"  \n\nI'm trying to create a MAC ACL that blocks ARP *responses* but allows ARP requests.\n\nWhat I have so far.. \n\n     permit host aaaa.bbbb.cccc host ffff.ffff.ffff 0x806 0x0\n     deny host aaaa.bbbb.cccc any 0x806 0x0\n     permit any any\n\nMy thoughts are ffff.ffff.ffff (broadcasts) would be arp requests...which would be allowed.  I then have the second line to block any other arp traffic (primarily arp responses).\n\n", "likes": null, "suggested_sort": null, "user_reports": [], "secure_media": null, "link_flair_text": null, "id": "64z8zt", "gilded": 0, "secure_media_embed": {}, "clicked": false, "score": 3, "report_reasons": null, "author": "smellypants", "saved": false, "mod_reports": [], "name": "t3_64z8zt", "subreddit_name_prefixed": "r/networking", "approved_by": null, "over_18": false, "domain": "self.networking", "hidden": false, "thumbnail": "", "subreddit_id": "t5_2qkaf", "edited": false, "link_flair_css_class": null, "author_flair_css_class": "", "downs": 0, "brand_safe": true, "archived": false, "removal_reason": null, "is_self": true, "hide_score": false, "spoiler": false, "permalink": "/r/networking/comments/64z8zt/mac_acl_question/", "num_reports": null, "locked": false, "stickied": false, "created": 1492043491.0, "url": "https://www.reddit.com/r/networking/comments/64z8zt/mac_acl_question/", "author_flair_text": "CCIE R&amp;S/CCNP DC/CCDP", "quarantine": false, "title": "MAC ACL question", "created_utc": 1492014691.0, "distinguished": null, "media": null, "upvote_ratio": 0.61, "num_comments": 10, "visited": false, "subreddit_type": "public", "ups": 3}}], "after": null, "before": null}}, {"kind": "Listing", "data": {"modhash": "", "children": [{"kind": "t1", "data": {"subreddit_id": "t5_2qkaf", "removal_reason": null, "link_id": "t3_64z8zt", "likes": null, "replies": {"kind": "Listing", "data": {"modhash": "", "children": [{"kind": "t1", "data": {"subreddit_id": "t5_2qkaf", "removal_reason": null, "link_id": "t3_64z8zt", "likes": null, "replies": {"kind": "Listing", "data": {"modhash": "", "children": [{"kind": "t1", "data": {"subreddit_id": "t5_2qkaf", "removal_reason": null, "link_id": "t3_64z8zt", "likes": null, "replies": {"kind": "Listing", "data": {"modhash": "", "children": [{"kind": "t1", "data": {"subreddit_id": "t5_2qkaf", "removal_reason": null, "link_id": "t3_64z8zt", "likes": null, "replies": {"kind": "Listing", "data": {"modhash": "", "children": [{"kind": "t1", "data": {"subreddit_id": "t5_2qkaf", "removal_reason": null, "link_id": "t3_64z8zt", "likes": null, "replies": {"kind": "Listing", "data": {"modhash": "", "children": [{"kind": "t1", "data": {"subreddit_id": "t5_2qkaf", "removal_reason": null, "link_id": "t3_64z8zt", "likes": null, "replies": {"kind": "Listing", "data": {"modhash": "", "children": [{"kind": "t1", "data": {"subreddit_id": "t5_2qkaf", "removal_reason": null, "link_id": "t3_64z8zt", "likes": null, "replies": {"kind": "Listing", "data": {"modhash": "", "children": [{"kind": "t1", "data": {"subreddit_id": "t5_2qkaf", "removal_reason": null, "link_id": "t3_64z8zt", "likes": null, "replies": "", "user_reports": [], "id": "dg8iauo", "gilded": 0, "archived": false, "score": 1, "report_reasons": null, "author": "smellypants", "parent_id": "t1_dg8gw2x", "subreddit_name_prefixed": "r/networking", "controversiality": 0, "body": "The original question was whether or not my MAC ACL is correct.  I'm trying to block ARP responses..but allow ARP requests.  I included a permit FFFF.FFFF.FFFF as the destination...as arp requests are broadcasts, and a deny any after the permit statement, as this would block arp responses.\n\n\nI've built two MAC ACLs in my career..just making sure it's not fucked!", "edited": false, "downs": 0, "body_html": "&lt;div class=\"md\"&gt;&lt;p&gt;The original question was whether or not my MAC ACL is correct.  I&amp;#39;m trying to block ARP responses..but allow ARP requests.  I included a permit FFFF.FFFF.FFFF as the destination...as arp requests are broadcasts, and a deny any after the permit statement, as this would block arp responses.&lt;/p&gt;\n\n&lt;p&gt;I&amp;#39;ve built two MAC ACLs in my career..just making sure it&amp;#39;s not fucked!&lt;/p&gt;\n&lt;/div&gt;", "subreddit": "networking", "name": "t1_dg8iauo", "score_hidden": false, "stickied": false, "created": 1492159659.0, "created_utc": 1492130859.0, "depth": 7, "mod_reports": [], "subreddit_type": "public", "ups": 1}}], "after": null, "before": null}}, "user_reports": [], "id": "dg8gw2x", "gilded": 0, "archived": false, "score": 1, "report_reasons": null, "author": "Expergefaction", "parent_id": "t1_dg7p32v", "subreddit_name_prefixed": "r/networking", "controversiality": 0, "body": "Right..... so what's the problem then?", "edited": false, "downs": 0, "body_html": "&lt;div class=\"md\"&gt;&lt;p&gt;Right..... so what&amp;#39;s the problem then?&lt;/p&gt;\n&lt;/div&gt;", "subreddit": "networking", "name": "t1_dg8gw2x", "score_hidden": false, "stickied": false, "created": 1492157720.0, "created_utc": 1492128920.0, "depth": 6, "mod_reports": [], "subreddit_type": "public", "ups": 1}}], "after": null, "before": null}}, "user_reports": [], "id": "dg7p32v", "gilded": 0, "archived": false, "score": 1, "report_reasons": null, "author": "smellypants", "parent_id": "t1_dg6s42f", "subreddit_name_prefixed": "r/networking", "controversiality": 0, "body": "For inter-vlan communication for OTV controlled VLANs, yes.\n\nIf I'm a host in VLAN 20 in DC2 talking to a host in VLAN 10 in DC1..\n\nVLAN 20 host sends its traffic to it's default gateway and the packet is re-encapsulated with a source MAC of DC2's VLAN 10 SVI.  It isn't routed, it's still OTV forwarded.  The only time it would be routed between the DCs would be if the source VLAN is one that isn't OTV controlled.", "edited": false, "downs": 0, "body_html": "&lt;div class=\"md\"&gt;&lt;p&gt;For inter-vlan communication for OTV controlled VLANs, yes.&lt;/p&gt;\n\n&lt;p&gt;If I&amp;#39;m a host in VLAN 20 in DC2 talking to a host in VLAN 10 in DC1..&lt;/p&gt;\n\n&lt;p&gt;VLAN 20 host sends its traffic to it&amp;#39;s default gateway and the packet is re-encapsulated with a source MAC of DC2&amp;#39;s VLAN 10 SVI.  It isn&amp;#39;t routed, it&amp;#39;s still OTV forwarded.  The only time it would be routed between the DCs would be if the source VLAN is one that isn&amp;#39;t OTV controlled.&lt;/p&gt;\n&lt;/div&gt;", "subreddit": "networking", "name": "t1_dg7p32v", "score_hidden": false, "stickied": false, "created": 1492125760.0, "created_utc": 1492096960.0, "depth": 5, "mod_reports": [], "subreddit_type": "public", "ups": 1}}], "after": null, "before": null}}, "user_reports": [], "id": "dg6s42f", "gilded": 0, "archived": false, "score": 2, "report_reasons": null, "author": "Expergefaction", "parent_id": "t1_dg69k62", "subreddit_name_prefixed": "r/networking", "controversiality": 0, "body": "Wouldnt the packet just route via the local SVIs on the 6509s and be on VLAN 10 before it even goes across the overlay? \n\nAm I missing something here?\n\nHost in vlan 20 -&gt; 6509 vlan20 SVI (DG) -&gt; connected vlan10 SVI -&gt; overlay.\n\nThen return: Host in vlan10 -&gt; HSRP DG -&gt; connected vlan20 SVI -&gt; overlay.", "edited": 1492041725.0, "downs": 0, "body_html": "&lt;div class=\"md\"&gt;&lt;p&gt;Wouldnt the packet just route via the local SVIs on the 6509s and be on VLAN 10 before it even goes across the overlay? &lt;/p&gt;\n\n&lt;p&gt;Am I missing something here?&lt;/p&gt;\n\n&lt;p&gt;Host in vlan 20 -&amp;gt; 6509 vlan20 SVI (DG) -&amp;gt; connected vlan10 SVI -&amp;gt; overlay.&lt;/p&gt;\n\n&lt;p&gt;Then return: Host in vlan10 -&amp;gt; HSRP DG -&amp;gt; connected vlan20 SVI -&amp;gt; overlay.&lt;/p&gt;\n&lt;/div&gt;", "subreddit": "networking", "name": "t1_dg6s42f", "score_hidden": false, "stickied": false, "created": 1492069546.0, "created_utc": 1492040746.0, "depth": 4, "mod_reports": [], "subreddit_type": "public", "ups": 2}}, {"kind": "t1", "data": {"subreddit_id": "t5_2qkaf", "removal_reason": null, "link_id": "t3_64z8zt", "likes": null, "replies": {"kind": "Listing", "data": {"modhash": "", "children": [{"kind": "t1", "data": {"subreddit_id": "t5_2qkaf", "removal_reason": null, "link_id": "t3_64z8zt", "likes": null, "replies": "", "user_reports": [], "id": "dg7p7j1", "gilded": 0, "archived": false, "score": 1, "report_reasons": null, "author": "smellypants", "parent_id": "t1_dg6fxbc", "subreddit_name_prefixed": "r/networking", "controversiality": 0, "body": "In my example both VLANs are OTV extended VLANs.\n", "edited": false, "downs": 0, "body_html": "&lt;div class=\"md\"&gt;&lt;p&gt;In my example both VLANs are OTV extended VLANs.&lt;/p&gt;\n&lt;/div&gt;", "subreddit": "networking", "name": "t1_dg7p7j1", "score_hidden": false, "stickied": false, "created": 1492125892.0, "created_utc": 1492097092.0, "depth": 5, "mod_reports": [], "subreddit_type": "public", "ups": 1}}], "after": null, "before": null}}, "user_reports": [], "id": "dg6fxbc", "gilded": 0, "archived": false, "score": 1, "report_reasons": null, "author": "Magsrgod", "parent_id": "t1_dg69k62", "subreddit_name_prefixed": "r/networking", "controversiality": 0, "body": "In your example is VLAN 20 a non OTV extended VLAN and VLAN 10 is an OTV extended Vlan? \n", "edited": false, "downs": 0, "body_html": "&lt;div class=\"md\"&gt;&lt;p&gt;In your example is VLAN 20 a non OTV extended VLAN and VLAN 10 is an OTV extended Vlan? &lt;/p&gt;\n&lt;/div&gt;", "subreddit": "networking", "name": "t1_dg6fxbc", "score_hidden": false, "stickied": false, "created": 1492055437.0, "created_utc": 1492026637.0, "depth": 4, "mod_reports": [], "subreddit_type": "public", "ups": 1}}], "after": null, "before": null}}, "user_reports": [], "id": "dg69k62", "gilded": 0, "archived": false, "score": 1, "report_reasons": null, "author": "smellypants", "parent_id": "t1_dg696sf", "subreddit_name_prefixed": "r/networking", "controversiality": 0, "body": "In theory, you block the HSRP mac so that they don't communicate  and elect one as active in one DC and standby in the other...hence the reason for filtering HSRP.  \n\nBut you have to allow the HSRP MAC in *our* scenerio...because if we block the HSRP mac address we'll break inter-vlan communication BETWEEN the DCs.\n\nFor example, VLAN 20 in DC2 wants to talk to VLAN 10 in DC1.  What is the L2 MAC source on that?  It's going to be the HSRP (or would be if we enabled HSRP on the 6500) MAC address of VLAN 10's SVI in DC2.  \n\nFiltering the HSRP MAC worked great for INTRA VLAN communication (for example, VLAN 10 in DC2 to VLAN 10 in DC1)..as the source MAC on that L2 frame is NOT an HSRP MAC.\n\n", "edited": false, "downs": 0, "body_html": "&lt;div class=\"md\"&gt;&lt;p&gt;In theory, you block the HSRP mac so that they don&amp;#39;t communicate  and elect one as active in one DC and standby in the other...hence the reason for filtering HSRP.  &lt;/p&gt;\n\n&lt;p&gt;But you have to allow the HSRP MAC in &lt;em&gt;our&lt;/em&gt; scenerio...because if we block the HSRP mac address we&amp;#39;ll break inter-vlan communication BETWEEN the DCs.&lt;/p&gt;\n\n&lt;p&gt;For example, VLAN 20 in DC2 wants to talk to VLAN 10 in DC1.  What is the L2 MAC source on that?  It&amp;#39;s going to be the HSRP (or would be if we enabled HSRP on the 6500) MAC address of VLAN 10&amp;#39;s SVI in DC2.  &lt;/p&gt;\n\n&lt;p&gt;Filtering the HSRP MAC worked great for INTRA VLAN communication (for example, VLAN 10 in DC2 to VLAN 10 in DC1)..as the source MAC on that L2 frame is NOT an HSRP MAC.&lt;/p&gt;\n&lt;/div&gt;", "subreddit": "networking", "name": "t1_dg69k62", "score_hidden": false, "stickied": false, "created": 1492048889.0, "created_utc": 1492020089.0, "depth": 3, "mod_reports": [], "subreddit_type": "public", "ups": 1}}], "after": null, "before": null}}, "user_reports": [], "id": "dg696sf", "gilded": 0, "archived": false, "score": 1, "report_reasons": null, "author": "packet_whisperer", "parent_id": "t1_dg65znp", "subreddit_name_prefixed": "r/networking", "controversiality": 0, "body": "If I'm understanding this correctly, the standard solution is to block the HSRP MACs across the OTV connection. ", "edited": false, "downs": 0, "body_html": "&lt;div class=\"md\"&gt;&lt;p&gt;If I&amp;#39;m understanding this correctly, the standard solution is to block the HSRP MACs across the OTV connection. &lt;/p&gt;\n&lt;/div&gt;", "subreddit": "networking", "name": "t1_dg696sf", "score_hidden": false, "stickied": false, "created": 1492048511.0, "created_utc": 1492019711.0, "depth": 2, "mod_reports": [], "subreddit_type": "public", "ups": 1}}], "after": null, "before": null}}, "user_reports": [], "id": "dg65znp", "gilded": 0, "archived": false, "score": 1, "report_reasons": null, "author": "smellypants", "parent_id": "t1_dg65j3m", "subreddit_name_prefixed": "r/networking", "controversiality": 0, "body": "haha well here it goes..\n\n(3K core w/ HSRP)DC1 ---OTV---DC2(6500 VSS pair)\n\nOTV running local gateways (lots, lots, lots of East-West traffic).\n\nI found that if I'm a host connected to DC1..and I arp for my gateway (10.0.0.1 for example), I'll get two responses: One MAC for the 3K HSRP MAC and one for the 6500 MAC.  All kinds of fuckery as it tries to use both MACs to forward traffic for inter-vlan communication.\n\nEasy fix right?  Enable HSRP on the 6500 and it'll use the local gateway to forward traffic as its closer!  Well, I can't...the OTV enabled device in DC1 is 1g ONLY, and the 3K core is 40G.  To get around this I connected my 1g ONLY ASR to the ToR switch.\n\nUnfortunately..I have a lot of hosts connected to that ToR switch.  The issue with simply enabling HSRP on the 6500 is that if a host has aaaa.bbbb.cccc as the mac (for example) for it's 10.0.0.1 gateway...the ToR switch is going to see that MAC address on two ports: Out to the 3K core..and out to the OTV device.\n\nNow to why I have the MAC ACL on...\n\nI want to allow the 6500 to send arp REQUESTS..so that it knows the next-hop for hosts are via the OTV link..but not be able to send arp RESPONSES..so to avoid the initial scenario: end-device arp cache fuckery.\n\nIf I can deploy a MAC ACL on the ASR to allow ARP requests..the OTV devices will know WHERE to forward traffic.  If I block ARP responses..end devices will assume that the local gateway is the ONLY destination for inter-vlan communication.\n\nMake sense?\n:P", "edited": false, "downs": 0, "body_html": "&lt;div class=\"md\"&gt;&lt;p&gt;haha well here it goes..&lt;/p&gt;\n\n&lt;p&gt;(3K core w/ HSRP)DC1 ---OTV---DC2(6500 VSS pair)&lt;/p&gt;\n\n&lt;p&gt;OTV running local gateways (lots, lots, lots of East-West traffic).&lt;/p&gt;\n\n&lt;p&gt;I found that if I&amp;#39;m a host connected to DC1..and I arp for my gateway (10.0.0.1 for example), I&amp;#39;ll get two responses: One MAC for the 3K HSRP MAC and one for the 6500 MAC.  All kinds of fuckery as it tries to use both MACs to forward traffic for inter-vlan communication.&lt;/p&gt;\n\n&lt;p&gt;Easy fix right?  Enable HSRP on the 6500 and it&amp;#39;ll use the local gateway to forward traffic as its closer!  Well, I can&amp;#39;t...the OTV enabled device in DC1 is 1g ONLY, and the 3K core is 40G.  To get around this I connected my 1g ONLY ASR to the ToR switch.&lt;/p&gt;\n\n&lt;p&gt;Unfortunately..I have a lot of hosts connected to that ToR switch.  The issue with simply enabling HSRP on the 6500 is that if a host has aaaa.bbbb.cccc as the mac (for example) for it&amp;#39;s 10.0.0.1 gateway...the ToR switch is going to see that MAC address on two ports: Out to the 3K core..and out to the OTV device.&lt;/p&gt;\n\n&lt;p&gt;Now to why I have the MAC ACL on...&lt;/p&gt;\n\n&lt;p&gt;I want to allow the 6500 to send arp REQUESTS..so that it knows the next-hop for hosts are via the OTV link..but not be able to send arp RESPONSES..so to avoid the initial scenario: end-device arp cache fuckery.&lt;/p&gt;\n\n&lt;p&gt;If I can deploy a MAC ACL on the ASR to allow ARP requests..the OTV devices will know WHERE to forward traffic.  If I block ARP responses..end devices will assume that the local gateway is the ONLY destination for inter-vlan communication.&lt;/p&gt;\n\n&lt;p&gt;Make sense?\n:P&lt;/p&gt;\n&lt;/div&gt;", "subreddit": "networking", "name": "t1_dg65znp", "score_hidden": false, "stickied": false, "created": 1492045294.0, "created_utc": 1492016494.0, "depth": 1, "mod_reports": [], "subreddit_type": "public", "ups": 1}}], "after": null, "before": null}}, "user_reports": [], "id": "dg65j3m", "gilded": 0, "archived": false, "score": 3, "report_reasons": null, "author": "packet_whisperer", "parent_id": "t3_64z8zt", "subreddit_name_prefixed": "r/networking", "controversiality": 0, "body": "I dodn't have much to offer here, but I am extremely curious about the situation that requires this kind of hackery.", "edited": false, "downs": 0, "body_html": "&lt;div class=\"md\"&gt;&lt;p&gt;I dodn&amp;#39;t have much to offer here, but I am extremely curious about the situation that requires this kind of hackery.&lt;/p&gt;\n&lt;/div&gt;", "subreddit": "networking", "name": "t1_dg65j3m", "score_hidden": false, "stickied": false, "created": 1492044819.0, "created_utc": 1492016019.0, "depth": 0, "mod_reports": [], "subreddit_type": "public", "ups": 3}}], "after": null, "before": null}}]