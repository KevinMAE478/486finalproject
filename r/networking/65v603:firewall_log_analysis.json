[{"kind": "Listing", "data": {"modhash": "", "children": [{"kind": "t3", "data": {"contest_mode": false, "banned_by": null, "media_embed": {}, "subreddit": "networking", "selftext_html": "&lt;!-- SC_OFF --&gt;&lt;div class=\"md\"&gt;&lt;p&gt;Hello Everyone,&lt;/p&gt;\n\n&lt;p&gt;I&amp;#39;ve been given a task at work and I could use some help getting through it more efficiently.  Basically we have a vendor installation on our internal network.  We gave them a /25 and they have around 75 devices connected to the network.  There is a firewall between their /25 and the rest of our network, which has a &amp;quot;default allow&amp;quot; policy, and my task is to switch it to default deny and only allow the specific white-listed traffic.&lt;/p&gt;\n\n&lt;p&gt;The problem is that the list they kept of services running is incomplete at best, and they haven&amp;#39;t made much effort to keep it up to date as things were added.  So I have about 8 hours of a firewall log that I&amp;#39;m supposed to go through and create a list of all the sessions (source/destination IP and port) so they can go through it and mark each one as approved or not approved, and then I&amp;#39;m supposed to build the firewall rules from that.&lt;/p&gt;\n\n&lt;p&gt;I&amp;#39;ve been going through it manually in Wireshark, taking down the details of each session I find and them manually filtering that session out to analyze what&amp;#39;s left, rinse and repeat.  Even though I know this isn&amp;#39;t nearly as much traffic as most of you deal with, I can still see this is going to take a long time and eat up a lot of hours in my week.  I know there must be a smarter and more efficient way to do this.&lt;/p&gt;\n\n&lt;p&gt;Can anyone offer any advice on how to get a list of each session, and possibly organize it in a useful way?    I&amp;#39;ve already done the major ports, 443/445/3389, but there is still a lot left.&lt;/p&gt;\n\n&lt;p&gt;Thank you!&lt;/p&gt;\n&lt;/div&gt;&lt;!-- SC_ON --&gt;", "selftext": "Hello Everyone,\n\nI've been given a task at work and I could use some help getting through it more efficiently.  Basically we have a vendor installation on our internal network.  We gave them a /25 and they have around 75 devices connected to the network.  There is a firewall between their /25 and the rest of our network, which has a \"default allow\" policy, and my task is to switch it to default deny and only allow the specific white-listed traffic.\n\nThe problem is that the list they kept of services running is incomplete at best, and they haven't made much effort to keep it up to date as things were added.  So I have about 8 hours of a firewall log that I'm supposed to go through and create a list of all the sessions (source/destination IP and port) so they can go through it and mark each one as approved or not approved, and then I'm supposed to build the firewall rules from that.\n\nI've been going through it manually in Wireshark, taking down the details of each session I find and them manually filtering that session out to analyze what's left, rinse and repeat.  Even though I know this isn't nearly as much traffic as most of you deal with, I can still see this is going to take a long time and eat up a lot of hours in my week.  I know there must be a smarter and more efficient way to do this.\n\nCan anyone offer any advice on how to get a list of each session, and possibly organize it in a useful way?    I've already done the major ports, 443/445/3389, but there is still a lot left.\n\nThank you!", "likes": null, "suggested_sort": null, "user_reports": [], "secure_media": null, "link_flair_text": null, "id": "65v603", "gilded": 0, "secure_media_embed": {}, "clicked": false, "score": 3, "report_reasons": null, "author": "LearningSysAdmin987", "saved": false, "mod_reports": [], "name": "t3_65v603", "subreddit_name_prefixed": "r/networking", "approved_by": null, "over_18": false, "domain": "self.networking", "hidden": false, "thumbnail": "", "subreddit_id": "t5_2qkaf", "edited": 1492431565.0, "link_flair_css_class": null, "author_flair_css_class": null, "downs": 0, "brand_safe": true, "archived": false, "removal_reason": null, "is_self": true, "hide_score": false, "spoiler": false, "permalink": "/r/networking/comments/65v603/firewall_log_analysis/", "num_reports": null, "locked": false, "stickied": false, "created": 1492459857.0, "url": "https://www.reddit.com/r/networking/comments/65v603/firewall_log_analysis/", "author_flair_text": null, "quarantine": false, "title": "Firewall Log Analysis", "created_utc": 1492431057.0, "distinguished": null, "media": null, "upvote_ratio": 0.81, "num_comments": 10, "visited": false, "subreddit_type": "public", "ups": 3}}], "after": null, "before": null}}, {"kind": "Listing", "data": {"modhash": "", "children": [{"kind": "t1", "data": {"subreddit_id": "t5_2qkaf", "removal_reason": null, "link_id": "t3_65v603", "likes": null, "replies": {"kind": "Listing", "data": {"modhash": "", "children": [{"kind": "t1", "data": {"subreddit_id": "t5_2qkaf", "removal_reason": null, "link_id": "t3_65v603", "likes": null, "replies": "", "user_reports": [], "id": "dgdki4x", "gilded": 0, "archived": false, "score": 1, "report_reasons": null, "author": "Kadover", "parent_id": "t1_dgditem", "subreddit_name_prefixed": "r/networking", "controversiality": 0, "body": "This is exactly how I would approach this. Being unable to document their product / solution, and how to make it work is unacceptable. It's legitimately terrifying. If they don't know how their own service operates, that reeks to me of the fact that there could be things running that I don't want running, this thing could be talking to things on the rest of the network it doesn't need to - and you don't want it to. ", "edited": false, "downs": 0, "body_html": "&lt;div class=\"md\"&gt;&lt;p&gt;This is exactly how I would approach this. Being unable to document their product / solution, and how to make it work is unacceptable. It&amp;#39;s legitimately terrifying. If they don&amp;#39;t know how their own service operates, that reeks to me of the fact that there could be things running that I don&amp;#39;t want running, this thing could be talking to things on the rest of the network it doesn&amp;#39;t need to - and you don&amp;#39;t want it to. &lt;/p&gt;\n&lt;/div&gt;", "subreddit": "networking", "name": "t1_dgdki4x", "score_hidden": false, "stickied": false, "created": 1492469385.0, "created_utc": 1492440585.0, "depth": 1, "mod_reports": [], "subreddit_type": "public", "ups": 1}}], "after": null, "before": null}}, "user_reports": [], "id": "dgditem", "gilded": 0, "archived": false, "score": 6, "report_reasons": null, "author": "PrettyDecentSort", "parent_id": "t3_65v603", "subreddit_name_prefixed": "r/networking", "controversiality": 0, "body": "I would push back on this whole scenario. It's up to the vendor to document what access they need. If they can't document what access they need, then that's a bigger problem than just this firewall exercise.\n\nTell the vendor that your firewall will go into lockdown mode on X date, and will permit only the flows that they have submitted justifications for at that time. If their service breaks because they don't know what the f they're doing, that's their fault.", "edited": false, "downs": 0, "body_html": "&lt;div class=\"md\"&gt;&lt;p&gt;I would push back on this whole scenario. It&amp;#39;s up to the vendor to document what access they need. If they can&amp;#39;t document what access they need, then that&amp;#39;s a bigger problem than just this firewall exercise.&lt;/p&gt;\n\n&lt;p&gt;Tell the vendor that your firewall will go into lockdown mode on X date, and will permit only the flows that they have submitted justifications for at that time. If their service breaks because they don&amp;#39;t know what the f they&amp;#39;re doing, that&amp;#39;s their fault.&lt;/p&gt;\n&lt;/div&gt;", "subreddit": "networking", "name": "t1_dgditem", "score_hidden": false, "stickied": false, "created": 1492467128.0, "created_utc": 1492438328.0, "depth": 0, "mod_reports": [], "subreddit_type": "public", "ups": 6}}, {"kind": "t1", "data": {"subreddit_id": "t5_2qkaf", "removal_reason": null, "link_id": "t3_65v603", "likes": null, "replies": {"kind": "Listing", "data": {"modhash": "", "children": [{"kind": "t1", "data": {"subreddit_id": "t5_2qkaf", "removal_reason": null, "link_id": "t3_65v603", "likes": null, "replies": {"kind": "Listing", "data": {"modhash": "", "children": [{"kind": "t1", "data": {"subreddit_id": "t5_2qkaf", "removal_reason": null, "link_id": "t3_65v603", "likes": null, "replies": {"kind": "Listing", "data": {"modhash": "", "children": [{"kind": "t1", "data": {"subreddit_id": "t5_2qkaf", "removal_reason": null, "link_id": "t3_65v603", "likes": null, "replies": "", "user_reports": [], "id": "dgdp35i", "gilded": 0, "archived": false, "score": 1, "report_reasons": null, "author": "LearningSysAdmin987", "parent_id": "t1_dgdkjpo", "subreddit_name_prefixed": "r/networking", "controversiality": 0, "body": "Good point, at a minimum I should capture another 8 hours during a different time of day to try and get some insight into that management stuff.  Everyone knows that the first round of this will inadvertently cut off some legit traffic, and we'll have to make adjustments as time goes on.", "edited": false, "downs": 0, "body_html": "&lt;div class=\"md\"&gt;&lt;p&gt;Good point, at a minimum I should capture another 8 hours during a different time of day to try and get some insight into that management stuff.  Everyone knows that the first round of this will inadvertently cut off some legit traffic, and we&amp;#39;ll have to make adjustments as time goes on.&lt;/p&gt;\n&lt;/div&gt;", "subreddit": "networking", "name": "t1_dgdp35i", "score_hidden": false, "stickied": false, "created": 1492474781.0, "created_utc": 1492445981.0, "depth": 3, "mod_reports": [], "subreddit_type": "public", "ups": 1}}], "after": null, "before": null}}, "user_reports": [], "id": "dgdkjpo", "gilded": 0, "archived": false, "score": 3, "report_reasons": null, "author": "Kadover", "parent_id": "t1_dgdhg20", "subreddit_name_prefixed": "r/networking", "controversiality": 0, "body": "I can't comment on Juniper stuff specifically, but one thing to keep in mind is that 8 hours of logs is likely just going to give you the 'operations' view. You may not see 'management' stuff, like the device reaching out for updates, or things like that, in an 8 hour window. ", "edited": false, "downs": 0, "body_html": "&lt;div class=\"md\"&gt;&lt;p&gt;I can&amp;#39;t comment on Juniper stuff specifically, but one thing to keep in mind is that 8 hours of logs is likely just going to give you the &amp;#39;operations&amp;#39; view. You may not see &amp;#39;management&amp;#39; stuff, like the device reaching out for updates, or things like that, in an 8 hour window. &lt;/p&gt;\n&lt;/div&gt;", "subreddit": "networking", "name": "t1_dgdkjpo", "score_hidden": false, "stickied": false, "created": 1492469440.0, "created_utc": 1492440640.0, "depth": 2, "mod_reports": [], "subreddit_type": "public", "ups": 3}}], "after": null, "before": null}}, "user_reports": [], "id": "dgdhg20", "gilded": 0, "archived": false, "score": 1, "report_reasons": null, "author": "LearningSysAdmin987", "parent_id": "t1_dgdese2", "subreddit_name_prefixed": "r/networking", "controversiality": 0, "body": "Juniper SRX300.  I'm used to dealing with networking/firewalls/etc (though no expert by any means) but figuring out the Juniper way of doing things is a whole learning curve in itself.", "edited": false, "downs": 0, "body_html": "&lt;div class=\"md\"&gt;&lt;p&gt;Juniper SRX300.  I&amp;#39;m used to dealing with networking/firewalls/etc (though no expert by any means) but figuring out the Juniper way of doing things is a whole learning curve in itself.&lt;/p&gt;\n&lt;/div&gt;", "subreddit": "networking", "name": "t1_dgdhg20", "score_hidden": false, "stickied": false, "created": 1492465096.0, "created_utc": 1492436296.0, "depth": 1, "mod_reports": [], "subreddit_type": "public", "ups": 1}}], "after": null, "before": null}}, "user_reports": [], "id": "dgdese2", "gilded": 0, "archived": false, "score": 3, "report_reasons": null, "author": "noukthx", "parent_id": "t3_65v603", "subreddit_name_prefixed": "r/networking", "controversiality": 0, "body": "What kind of firewall have you got?\n\n\nEasiest way is to look at the sessions table on the firewall for sessions in flight. Work out what you know should be permitted, and build rules above the default permit to allow them.\n\n\nAs you get more and more rules, less and less should hit the default permit. Get the default permit to generate logs for sessions that hit it and then parse the logs for the stuff you've missed.\n\n\nYou should be able to manipulate the 8hrs of logs down to a distinct list of addresses, ports/protocols pretty easily.", "edited": false, "downs": 0, "body_html": "&lt;div class=\"md\"&gt;&lt;p&gt;What kind of firewall have you got?&lt;/p&gt;\n\n&lt;p&gt;Easiest way is to look at the sessions table on the firewall for sessions in flight. Work out what you know should be permitted, and build rules above the default permit to allow them.&lt;/p&gt;\n\n&lt;p&gt;As you get more and more rules, less and less should hit the default permit. Get the default permit to generate logs for sessions that hit it and then parse the logs for the stuff you&amp;#39;ve missed.&lt;/p&gt;\n\n&lt;p&gt;You should be able to manipulate the 8hrs of logs down to a distinct list of addresses, ports/protocols pretty easily.&lt;/p&gt;\n&lt;/div&gt;", "subreddit": "networking", "name": "t1_dgdese2", "score_hidden": false, "stickied": false, "created": 1492460379.0, "created_utc": 1492431579.0, "depth": 0, "mod_reports": [], "subreddit_type": "public", "ups": 3}}, {"kind": "t1", "data": {"subreddit_id": "t5_2qkaf", "removal_reason": null, "link_id": "t3_65v603", "likes": null, "replies": {"kind": "Listing", "data": {"modhash": "", "children": [{"kind": "t1", "data": {"subreddit_id": "t5_2qkaf", "removal_reason": null, "link_id": "t3_65v603", "likes": null, "replies": "", "user_reports": [], "id": "dgdknjg", "gilded": 0, "archived": false, "score": 2, "report_reasons": null, "author": "Kadover", "parent_id": "t1_dgdjlm1", "subreddit_name_prefixed": "r/networking", "controversiality": 0, "body": "Besides pushing the vendor for documentation, this is exactly what I came here to say. This would be my approach. Take each session in Conversations &gt; TCP/UDP and figure out if it's needed or not. ", "edited": false, "downs": 0, "body_html": "&lt;div class=\"md\"&gt;&lt;p&gt;Besides pushing the vendor for documentation, this is exactly what I came here to say. This would be my approach. Take each session in Conversations &amp;gt; TCP/UDP and figure out if it&amp;#39;s needed or not. &lt;/p&gt;\n&lt;/div&gt;", "subreddit": "networking", "name": "t1_dgdknjg", "score_hidden": false, "stickied": false, "created": 1492469575.0, "created_utc": 1492440775.0, "depth": 1, "mod_reports": [], "subreddit_type": "public", "ups": 2}}, {"kind": "t1", "data": {"subreddit_id": "t5_2qkaf", "removal_reason": null, "link_id": "t3_65v603", "likes": null, "replies": "", "user_reports": [], "id": "dgdoyvo", "gilded": 0, "archived": false, "score": 1, "report_reasons": null, "author": "LearningSysAdmin987", "parent_id": "t1_dgdjlm1", "subreddit_name_prefixed": "r/networking", "controversiality": 0, "body": "I completely missed that report, I had been going through Statistics &gt; IPv4 Statistics.  Thanks very much!", "edited": false, "downs": 0, "body_html": "&lt;div class=\"md\"&gt;&lt;p&gt;I completely missed that report, I had been going through Statistics &amp;gt; IPv4 Statistics.  Thanks very much!&lt;/p&gt;\n&lt;/div&gt;", "subreddit": "networking", "name": "t1_dgdoyvo", "score_hidden": false, "stickied": false, "created": 1492474643.0, "created_utc": 1492445843.0, "depth": 1, "mod_reports": [], "subreddit_type": "public", "ups": 1}}], "after": null, "before": null}}, "user_reports": [], "id": "dgdjlm1", "gilded": 0, "archived": false, "score": 3, "report_reasons": null, "author": "Rex9", "parent_id": "t3_65v603", "subreddit_name_prefixed": "r/networking", "controversiality": 0, "body": "If you have it in wireshark, wouldn't pulling up the Statistics &gt; conversations report work? It lists everything in tabs. You can look at the TCP and UDP tabs and see everything talking by endpoint and source/dest ports. ", "edited": false, "downs": 0, "body_html": "&lt;div class=\"md\"&gt;&lt;p&gt;If you have it in wireshark, wouldn&amp;#39;t pulling up the Statistics &amp;gt; conversations report work? It lists everything in tabs. You can look at the TCP and UDP tabs and see everything talking by endpoint and source/dest ports. &lt;/p&gt;\n&lt;/div&gt;", "subreddit": "networking", "name": "t1_dgdjlm1", "score_hidden": false, "stickied": false, "created": 1492468205.0, "created_utc": 1492439405.0, "depth": 0, "mod_reports": [], "subreddit_type": "public", "ups": 3}}, {"kind": "t1", "data": {"subreddit_id": "t5_2qkaf", "removal_reason": null, "link_id": "t3_65v603", "likes": null, "replies": "", "user_reports": [], "id": "dge18dl", "gilded": 0, "archived": false, "score": 1, "report_reasons": null, "author": "grilledcheeseadmin", "parent_id": "t3_65v603", "subreddit_name_prefixed": "r/networking", "controversiality": 0, "body": "Push vendor.\n\nBut... nearly all firewalls have a \"permit and log\" option.\n\nGet your list, add it to \"permit and don't log\"  (I'm assuming that's what you want), then leave the \"permit and log\" as the last rule.  Check the log periodically, add the exceptions to your list.  Eventually you should stop getting entries.  At that point, change the rule to \"deny and log\" and have a margarita.", "edited": false, "downs": 0, "body_html": "&lt;div class=\"md\"&gt;&lt;p&gt;Push vendor.&lt;/p&gt;\n\n&lt;p&gt;But... nearly all firewalls have a &amp;quot;permit and log&amp;quot; option.&lt;/p&gt;\n\n&lt;p&gt;Get your list, add it to &amp;quot;permit and don&amp;#39;t log&amp;quot;  (I&amp;#39;m assuming that&amp;#39;s what you want), then leave the &amp;quot;permit and log&amp;quot; as the last rule.  Check the log periodically, add the exceptions to your list.  Eventually you should stop getting entries.  At that point, change the rule to &amp;quot;deny and log&amp;quot; and have a margarita.&lt;/p&gt;\n&lt;/div&gt;", "subreddit": "networking", "name": "t1_dge18dl", "score_hidden": false, "stickied": false, "created": 1492488370.0, "created_utc": 1492459570.0, "depth": 0, "mod_reports": [], "subreddit_type": "public", "ups": 1}}], "after": null, "before": null}}]