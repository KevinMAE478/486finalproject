[{"kind": "Listing", "data": {"modhash": "", "children": [{"kind": "t3", "data": {"contest_mode": false, "banned_by": null, "media_embed": {}, "subreddit": "networking", "selftext_html": "&lt;!-- SC_OFF --&gt;&lt;div class=\"md\"&gt;&lt;p&gt;SRX as CPE, I have WAN egress shaper in place but heavy downstream traffic is still problematic&lt;/p&gt;\n\n&lt;p&gt;since it&amp;#39;s not possible to shape on ingress, how can I apply a policy to shape traffic from WAN to LAN? multiple WAN and LAN ports. The goal is to shape traffic from a single WAN port to any LAN port to a defined rate.&lt;/p&gt;\n&lt;/div&gt;&lt;!-- SC_ON --&gt;", "selftext": "SRX as CPE, I have WAN egress shaper in place but heavy downstream traffic is still problematic\n\nsince it's not possible to shape on ingress, how can I apply a policy to shape traffic from WAN to LAN? multiple WAN and LAN ports. The goal is to shape traffic from a single WAN port to any LAN port to a defined rate.", "likes": null, "suggested_sort": null, "user_reports": [], "secure_media": null, "link_flair_text": null, "id": "65a58u", "gilded": 0, "secure_media_embed": {}, "clicked": false, "score": 7, "report_reasons": null, "author": "cantbenamed", "saved": false, "mod_reports": [], "name": "t3_65a58u", "subreddit_name_prefixed": "r/networking", "approved_by": null, "over_18": false, "domain": "self.networking", "hidden": false, "thumbnail": "", "subreddit_id": "t5_2qkaf", "edited": false, "link_flair_css_class": null, "author_flair_css_class": null, "downs": 0, "brand_safe": true, "archived": false, "removal_reason": null, "is_self": true, "hide_score": false, "spoiler": false, "permalink": "/r/networking/comments/65a58u/srx_wan_qos/", "num_reports": null, "locked": false, "stickied": false, "created": 1492167462.0, "url": "https://www.reddit.com/r/networking/comments/65a58u/srx_wan_qos/", "author_flair_text": null, "quarantine": false, "title": "SRX WAN QoS", "created_utc": 1492138662.0, "distinguished": null, "media": null, "upvote_ratio": 0.9, "num_comments": 5, "visited": false, "subreddit_type": "public", "ups": 7}}], "after": null, "before": null}}, {"kind": "Listing", "data": {"modhash": "", "children": [{"kind": "t1", "data": {"subreddit_id": "t5_2qkaf", "removal_reason": null, "link_id": "t3_65a58u", "likes": null, "replies": {"kind": "Listing", "data": {"modhash": "", "children": [{"kind": "t1", "data": {"subreddit_id": "t5_2qkaf", "removal_reason": null, "link_id": "t3_65a58u", "likes": null, "replies": {"kind": "Listing", "data": {"modhash": "", "children": [{"kind": "t1", "data": {"subreddit_id": "t5_2qkaf", "removal_reason": null, "link_id": "t3_65a58u", "likes": null, "replies": "", "user_reports": [], "id": "dg8z9kl", "gilded": 0, "archived": false, "score": 1, "report_reasons": null, "author": "Skilldibop", "parent_id": "t1_dg8yt6l", "subreddit_name_prefixed": "r/networking", "controversiality": 0, "body": "That method may work if you have a 1:1 ratio of WAN to LAN interfaces and traffic from WAN1 only ever goes to LAN1 etc. If traffic from WAN1 can go to LAN1 and LAN2 then you have to shape both down to 50% of WAN1 or less to prevent saturation. But that then means if LAN1 isn't using WAN1 you've gimped LAN2 and are wasting bandwidth on WAN1.\n\nSeriously, just pony up and get more bandwidth. Save yourself the headache :)\n", "edited": false, "downs": 0, "body_html": "&lt;div class=\"md\"&gt;&lt;p&gt;That method may work if you have a 1:1 ratio of WAN to LAN interfaces and traffic from WAN1 only ever goes to LAN1 etc. If traffic from WAN1 can go to LAN1 and LAN2 then you have to shape both down to 50% of WAN1 or less to prevent saturation. But that then means if LAN1 isn&amp;#39;t using WAN1 you&amp;#39;ve gimped LAN2 and are wasting bandwidth on WAN1.&lt;/p&gt;\n\n&lt;p&gt;Seriously, just pony up and get more bandwidth. Save yourself the headache :)&lt;/p&gt;\n&lt;/div&gt;", "subreddit": "networking", "name": "t1_dg8z9kl", "score_hidden": false, "stickied": false, "created": 1492193305.0, "created_utc": 1492164505.0, "depth": 2, "mod_reports": [], "subreddit_type": "public", "ups": 1}}], "after": null, "before": null}}, "user_reports": [], "id": "dg8yt6l", "gilded": 0, "archived": false, "score": 1, "report_reasons": null, "author": "cantbenamed", "parent_id": "t1_dg8x8i6", "subreddit_name_prefixed": "r/networking", "controversiality": 0, "body": "I shaped egress facing LAN, not perfect but the impact to other applications is much less noticeable. Now just need to figure out how to do it with multiple WAN interfaces, maybe separate routing instances.", "edited": false, "downs": 0, "body_html": "&lt;div class=\"md\"&gt;&lt;p&gt;I shaped egress facing LAN, not perfect but the impact to other applications is much less noticeable. Now just need to figure out how to do it with multiple WAN interfaces, maybe separate routing instances.&lt;/p&gt;\n&lt;/div&gt;", "subreddit": "networking", "name": "t1_dg8yt6l", "score_hidden": false, "stickied": false, "created": 1492191788.0, "created_utc": 1492162988.0, "depth": 1, "mod_reports": [], "subreddit_type": "public", "ups": 1}}], "after": null, "before": null}}, "user_reports": [], "id": "dg8x8i6", "gilded": 0, "archived": false, "score": 2, "report_reasons": null, "author": "Skilldibop", "parent_id": "t3_65a58u", "subreddit_name_prefixed": "r/networking", "controversiality": 0, "body": "You can police inbound. But this is a blunt instrument and can ruin performance if used incorrectly.\n\nSome key points to understand:\n\n* QoS will only ever hurt something to preserve something else.\n\n* There is no QoS on the internet, so trying to apply QoS to Internet traffic is somewhat futile.\n\n* If you have more traffic than you have bandwidth, the only solution is to provision more bandwidth or find a way to reduce the demand for traffic.", "edited": false, "downs": 0, "body_html": "&lt;div class=\"md\"&gt;&lt;p&gt;You can police inbound. But this is a blunt instrument and can ruin performance if used incorrectly.&lt;/p&gt;\n\n&lt;p&gt;Some key points to understand:&lt;/p&gt;\n\n&lt;ul&gt;\n&lt;li&gt;&lt;p&gt;QoS will only ever hurt something to preserve something else.&lt;/p&gt;&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;There is no QoS on the internet, so trying to apply QoS to Internet traffic is somewhat futile.&lt;/p&gt;&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;If you have more traffic than you have bandwidth, the only solution is to provision more bandwidth or find a way to reduce the demand for traffic.&lt;/p&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/div&gt;", "subreddit": "networking", "name": "t1_dg8x8i6", "score_hidden": false, "stickied": false, "created": 1492186665.0, "created_utc": 1492157865.0, "depth": 0, "mod_reports": [], "subreddit_type": "public", "ups": 2}}, {"kind": "t1", "data": {"subreddit_id": "t5_2qkaf", "removal_reason": null, "link_id": "t3_65a58u", "likes": null, "replies": {"kind": "Listing", "data": {"modhash": "", "children": [{"kind": "t1", "data": {"subreddit_id": "t5_2qkaf", "removal_reason": null, "link_id": "t3_65a58u", "likes": null, "replies": "", "user_reports": [], "id": "dg8rnoq", "gilded": 0, "archived": false, "score": 1, "report_reasons": null, "author": "cantbenamed", "parent_id": "t1_dg8om5q", "subreddit_name_prefixed": "r/networking", "controversiality": 0, "body": "it gets a bit complex when there are multiple WAN/LAN ports involved. hierarchical-scheduler on branch SRX can be applied across several interfaces", "edited": false, "downs": 0, "body_html": "&lt;div class=\"md\"&gt;&lt;p&gt;it gets a bit complex when there are multiple WAN/LAN ports involved. hierarchical-scheduler on branch SRX can be applied across several interfaces&lt;/p&gt;\n&lt;/div&gt;", "subreddit": "networking", "name": "t1_dg8rnoq", "score_hidden": false, "stickied": false, "created": 1492173538.0, "created_utc": 1492144738.0, "depth": 1, "mod_reports": [], "subreddit_type": "public", "ups": 1}}], "after": null, "before": null}}, "user_reports": [], "id": "dg8om5q", "gilded": 0, "archived": false, "score": 1, "report_reasons": null, "author": "error404", "parent_id": "t3_65a58u", "subreddit_name_prefixed": "r/networking", "controversiality": 0, "body": "By the time the packet has arrived at your box, it's already spent its time on the wire. You can choose to discard it or deliver it; how it's shaped/queued when being sent to you is not your decision. This is why you can't shape on ingress - it's pointless (and in fact detrimental) to add extra ingress queues - these packets will cross the fabric and queue in the egress queue if necessary. For the same reason, you can't really do any useful QoS on the downstream side since you don't control the queue there, so don't expect any big performance gains.\n\nYou can *police* on ingress, using a firewall filter on the WAN port. Or you can police on egress towards each LAN port, if you want them to each have their own maximum rate. Fair protocols (e.g. TCP) should respond to these drops, while will help keep the upstream queue empty and could help with latency during congestion. So maybe it will get you somewhere. But don't expect much.", "edited": false, "downs": 0, "body_html": "&lt;div class=\"md\"&gt;&lt;p&gt;By the time the packet has arrived at your box, it&amp;#39;s already spent its time on the wire. You can choose to discard it or deliver it; how it&amp;#39;s shaped/queued when being sent to you is not your decision. This is why you can&amp;#39;t shape on ingress - it&amp;#39;s pointless (and in fact detrimental) to add extra ingress queues - these packets will cross the fabric and queue in the egress queue if necessary. For the same reason, you can&amp;#39;t really do any useful QoS on the downstream side since you don&amp;#39;t control the queue there, so don&amp;#39;t expect any big performance gains.&lt;/p&gt;\n\n&lt;p&gt;You can &lt;em&gt;police&lt;/em&gt; on ingress, using a firewall filter on the WAN port. Or you can police on egress towards each LAN port, if you want them to each have their own maximum rate. Fair protocols (e.g. TCP) should respond to these drops, while will help keep the upstream queue empty and could help with latency during congestion. So maybe it will get you somewhere. But don&amp;#39;t expect much.&lt;/p&gt;\n&lt;/div&gt;", "subreddit": "networking", "name": "t1_dg8om5q", "score_hidden": false, "stickied": false, "created": 1492168584.0, "created_utc": 1492139784.0, "depth": 0, "mod_reports": [], "subreddit_type": "public", "ups": 1}}], "after": null, "before": null}}]