[{"kind": "Listing", "data": {"modhash": "", "children": [{"kind": "t3", "data": {"contest_mode": false, "banned_by": null, "media_embed": {}, "subreddit": "sysadmin", "selftext_html": "&lt;!-- SC_OFF --&gt;&lt;div class=\"md\"&gt;&lt;p&gt;Greetings all,\nI have searched far and wide across Middle Earth for a single Office 365 connection script that also connects to ALL Office 365 services, including Azure Active Directory and Azure Resource Manager - The Mythical &amp;#39;One Script to Rule the World&amp;#39;. &lt;/p&gt;\n\n&lt;p&gt;But alas, I could not find one.&lt;/p&gt;\n\n&lt;p&gt;So I have spent hours updating my original script to include all the following services \n- Exchange Online \n- Azure AD v1.0 \n- Azure AD v2.0 \n- Azure Resource Manager \n- SharePoint Online \n- Skype for Business Online \n- Exchange Online Protection \n- Security and Compliance Center.&lt;/p&gt;\n\n&lt;p&gt;Download and Resource links below -&lt;/p&gt;\n\n&lt;p&gt;TechNet Download link - &lt;a href=\"https://gallery.technet.microsoft.com/Office-365-and-Azure-e36eabeb\"&gt;https://gallery.technet.microsoft.com/Office-365-and-Azure-e36eabeb&lt;/a&gt;\n- If you download and like the script, please rate it on TechNet.&lt;/p&gt;\n\n&lt;p&gt;Pre-requisites -\nFollow this guide to install the PowerShell modules - \nHow to configure your desktop PC for Office 365 Administration - \n&lt;a href=\"http://www.365admin.com.au/2017/01/how-to-configure-your-desktop-pc-for.html\"&gt;http://www.365admin.com.au/2017/01/how-to-configure-your-desktop-pc-for.html&lt;/a&gt;&lt;/p&gt;\n\n&lt;p&gt;Usage Guide -\nFollow this guide to edit the PowerShell Connection Script - \nHow to connect to Office 365 via PowerShell \n&lt;a href=\"http://www.365admin.com.au/2017/01/how-to-connect-to-office-365-via.html\"&gt;http://www.365admin.com.au/2017/01/how-to-connect-to-office-365-via.html&lt;/a&gt;&lt;/p&gt;\n\n&lt;p&gt;Enjoy...&lt;/p&gt;\n&lt;/div&gt;&lt;!-- SC_ON --&gt;", "selftext": "Greetings all,\nI have searched far and wide across Middle Earth for a single Office 365 connection script that also connects to ALL Office 365 services, including Azure Active Directory and Azure Resource Manager - The Mythical 'One Script to Rule the World'. \n\nBut alas, I could not find one.\n\nSo I have spent hours updating my original script to include all the following services \n- Exchange Online \n- Azure AD v1.0 \n- Azure AD v2.0 \n- Azure Resource Manager \n- SharePoint Online \n- Skype for Business Online \n- Exchange Online Protection \n- Security and Compliance Center.\n\nDownload and Resource links below -\n\nTechNet Download link - https://gallery.technet.microsoft.com/Office-365-and-Azure-e36eabeb\n- If you download and like the script, please rate it on TechNet.\n\nPre-requisites -\nFollow this guide to install the PowerShell modules - \nHow to configure your desktop PC for Office 365 Administration - \nhttp://www.365admin.com.au/2017/01/how-to-configure-your-desktop-pc-for.html\n\nUsage Guide -\nFollow this guide to edit the PowerShell Connection Script - \nHow to connect to Office 365 via PowerShell \nhttp://www.365admin.com.au/2017/01/how-to-connect-to-office-365-via.html\n\nEnjoy...", "likes": null, "suggested_sort": null, "user_reports": [], "secure_media": null, "link_flair_text": null, "id": "65hmc4", "gilded": 0, "secure_media_embed": {}, "clicked": false, "score": 40, "report_reasons": null, "author": "365Admin", "saved": false, "mod_reports": [], "name": "t3_65hmc4", "subreddit_name_prefixed": "r/sysadmin", "approved_by": null, "over_18": false, "domain": "self.sysadmin", "hidden": false, "thumbnail": "self", "subreddit_id": "t5_2qnp7", "edited": 1492260701.0, "link_flair_css_class": null, "author_flair_css_class": "", "downs": 0, "brand_safe": true, "archived": false, "removal_reason": null, "is_self": true, "hide_score": false, "spoiler": false, "permalink": "/r/sysadmin/comments/65hmc4/one_office_365_connection_script_to_rule_the/", "num_reports": null, "locked": false, "stickied": false, "created": 1492264022.0, "url": "https://www.reddit.com/r/sysadmin/comments/65hmc4/one_office_365_connection_script_to_rule_the/", "author_flair_text": "365Admin.com.au", "quarantine": false, "title": "One Office 365 Connection Script to Rule the World (includes Azure AD)", "created_utc": 1492235222.0, "distinguished": null, "media": null, "upvote_ratio": 0.85, "num_comments": 30, "visited": false, "subreddit_type": "public", "ups": 40}}], "after": null, "before": null}}, {"kind": "Listing", "data": {"modhash": "", "children": [{"kind": "t1", "data": {"subreddit_id": "t5_2qnp7", "removal_reason": null, "link_id": "t3_65hmc4", "likes": null, "replies": {"kind": "Listing", "data": {"modhash": "", "children": [{"kind": "t1", "data": {"subreddit_id": "t5_2qnp7", "removal_reason": null, "link_id": "t3_65hmc4", "likes": null, "replies": {"kind": "Listing", "data": {"modhash": "", "children": [{"kind": "t1", "data": {"subreddit_id": "t5_2qnp7", "removal_reason": null, "link_id": "t3_65hmc4", "likes": null, "replies": {"kind": "Listing", "data": {"modhash": "", "children": [{"kind": "t1", "data": {"subreddit_id": "t5_2qnp7", "removal_reason": null, "link_id": "t3_65hmc4", "likes": null, "replies": "", "user_reports": [], "id": "dgbir5j", "gilded": 0, "archived": false, "score": 1, "report_reasons": null, "author": "Wargala", "parent_id": "t1_dgb6p8s", "subreddit_name_prefixed": "r/sysadmin", "controversiality": 0, "body": "Happy to help internet stranger! :)", "edited": false, "downs": 0, "body_html": "&lt;div class=\"md\"&gt;&lt;p&gt;Happy to help internet stranger! :)&lt;/p&gt;\n&lt;/div&gt;", "subreddit": "sysadmin", "name": "t1_dgbir5j", "score_hidden": false, "stickied": false, "created": 1492336874.0, "created_utc": 1492308074.0, "depth": 3, "mod_reports": [], "subreddit_type": "public", "ups": 1}}], "after": null, "before": null}}, "user_reports": [], "id": "dgb6p8s", "gilded": 0, "archived": false, "score": 1, "report_reasons": null, "author": "365Admin", "parent_id": "t1_dgawvyn", "subreddit_name_prefixed": "r/sysadmin", "controversiality": 0, "body": "Excellent... I will try over the Easter break to try and merge them.\nNot sure if if I can have 'One Script to Rule Them All' yet. I may need to have two, one for MFA and one for the others.\nThanks @Wargala.", "edited": false, "downs": 0, "body_html": "&lt;div class=\"md\"&gt;&lt;p&gt;Excellent... I will try over the Easter break to try and merge them.\nNot sure if if I can have &amp;#39;One Script to Rule Them All&amp;#39; yet. I may need to have two, one for MFA and one for the others.\nThanks @Wargala.&lt;/p&gt;\n&lt;/div&gt;", "subreddit": "sysadmin", "name": "t1_dgb6p8s", "score_hidden": false, "stickied": false, "created": 1492319688.0, "created_utc": 1492290888.0, "depth": 2, "mod_reports": [], "subreddit_type": "public", "ups": 1}}, {"kind": "t1", "data": {"subreddit_id": "t5_2qnp7", "removal_reason": null, "link_id": "t3_65hmc4", "likes": null, "replies": {"kind": "Listing", "data": {"modhash": "", "children": [{"kind": "t1", "data": {"subreddit_id": "t5_2qnp7", "removal_reason": null, "link_id": "t3_65hmc4", "likes": null, "replies": "", "user_reports": [], "id": "dgbiquy", "gilded": 0, "archived": false, "score": 2, "report_reasons": null, "author": "Wargala", "parent_id": "t1_dgbav92", "subreddit_name_prefixed": "r/sysadmin", "controversiality": 0, "body": "Yeah, I wondered that too. :)  That's why I threw it up on my Github, so people wouldn't have to scramble to figure it out.  It's WAY more difficult than it should be from Microsoft. :)", "edited": false, "downs": 0, "body_html": "&lt;div class=\"md\"&gt;&lt;p&gt;Yeah, I wondered that too. :)  That&amp;#39;s why I threw it up on my Github, so people wouldn&amp;#39;t have to scramble to figure it out.  It&amp;#39;s WAY more difficult than it should be from Microsoft. :)&lt;/p&gt;\n&lt;/div&gt;", "subreddit": "sysadmin", "name": "t1_dgbiquy", "score_hidden": false, "stickied": false, "created": 1492336861.0, "created_utc": 1492308061.0, "depth": 3, "mod_reports": [], "subreddit_type": "public", "ups": 2}}, {"kind": "t1", "data": {"subreddit_id": "t5_2qnp7", "removal_reason": null, "link_id": "t3_65hmc4", "likes": null, "replies": "", "user_reports": [], "id": "dgbavbl", "gilded": 0, "archived": false, "score": 1, "report_reasons": null, "author": "FactorialExpectBot", "parent_id": "t1_dgbav92", "subreddit_name_prefixed": "r/sysadmin", "controversiality": 0, "body": "&gt; 365!\n\n365! \u2248 2.51 * 10^778\n\n/r/unexpectedfactorial", "edited": false, "downs": 0, "body_html": "&lt;div class=\"md\"&gt;&lt;blockquote&gt;\n&lt;p&gt;365!&lt;/p&gt;\n&lt;/blockquote&gt;\n\n&lt;p&gt;365! \u2248 2.51 * 10&lt;sup&gt;778&lt;/sup&gt;&lt;/p&gt;\n\n&lt;p&gt;&lt;a href=\"/r/unexpectedfactorial\"&gt;/r/unexpectedfactorial&lt;/a&gt;&lt;/p&gt;\n&lt;/div&gt;", "subreddit": "sysadmin", "name": "t1_dgbavbl", "score_hidden": false, "stickied": false, "created": 1492325579.0, "created_utc": 1492296779.0, "depth": 3, "mod_reports": [], "subreddit_type": "public", "ups": 1}}, {"kind": "t1", "data": {"subreddit_id": "t5_2qnp7", "removal_reason": null, "link_id": "t3_65hmc4", "likes": null, "replies": {"kind": "Listing", "data": {"modhash": "", "children": [{"kind": "t1", "data": {"subreddit_id": "t5_2qnp7", "removal_reason": null, "link_id": "t3_65hmc4", "likes": null, "replies": {"kind": "Listing", "data": {"modhash": "", "children": [{"kind": "t1", "data": {"subreddit_id": "t5_2qnp7", "removal_reason": null, "link_id": "t3_65hmc4", "likes": null, "replies": "", "user_reports": [], "id": "dgbxr92", "gilded": 0, "archived": false, "score": 1, "report_reasons": null, "author": "365Admin", "parent_id": "t1_dgbutj0", "subreddit_name_prefixed": "r/sysadmin", "controversiality": 0, "body": "Still in progress, but I have actually had mild success.\nCurrently, I can have a single script using two accounts. \n\nAdmin-MFA can connect to Exchange Online and Azure AD v2.0\nAdmin-Plain can connect to everything else.\n\nI just have different user names in the script.\nMost likely will end up with 3 scripts. One for completely MFA. One for the two accounts as mentioned. And one for no MFA.\n\nI will also probably create a zip of the individual MFA scripts, as most people will probably get pissed off entering their MFA creds and verification texts 4 or 6 times if they just want to do some Exchange Online work.", "edited": false, "downs": 0, "body_html": "&lt;div class=\"md\"&gt;&lt;p&gt;Still in progress, but I have actually had mild success.\nCurrently, I can have a single script using two accounts. &lt;/p&gt;\n\n&lt;p&gt;Admin-MFA can connect to Exchange Online and Azure AD v2.0\nAdmin-Plain can connect to everything else.&lt;/p&gt;\n\n&lt;p&gt;I just have different user names in the script.\nMost likely will end up with 3 scripts. One for completely MFA. One for the two accounts as mentioned. And one for no MFA.&lt;/p&gt;\n\n&lt;p&gt;I will also probably create a zip of the individual MFA scripts, as most people will probably get pissed off entering their MFA creds and verification texts 4 or 6 times if they just want to do some Exchange Online work.&lt;/p&gt;\n&lt;/div&gt;", "subreddit": "sysadmin", "name": "t1_dgbxr92", "score_hidden": false, "stickied": false, "created": 1492370577.0, "created_utc": 1492341777.0, "depth": 5, "mod_reports": [], "subreddit_type": "public", "ups": 1}}], "after": null, "before": null}}, "user_reports": [], "id": "dgbutj0", "gilded": 0, "archived": false, "score": 1, "report_reasons": null, "author": "feckinarse", "parent_id": "t1_dgbrofa", "subreddit_name_prefixed": "r/sysadmin", "controversiality": 0, "body": "Looking forward to your next version, thanks.", "edited": false, "downs": 0, "body_html": "&lt;div class=\"md\"&gt;&lt;p&gt;Looking forward to your next version, thanks.&lt;/p&gt;\n&lt;/div&gt;", "subreddit": "sysadmin", "name": "t1_dgbutj0", "score_hidden": false, "stickied": false, "created": 1492360650.0, "created_utc": 1492331850.0, "depth": 4, "mod_reports": [], "subreddit_type": "public", "ups": 1}}], "after": null, "before": null}}, "user_reports": [], "id": "dgbrofa", "gilded": 0, "archived": false, "score": 1, "report_reasons": null, "author": "365Admin", "parent_id": "t1_dgbav92", "subreddit_name_prefixed": "r/sysadmin", "controversiality": 0, "body": "Sorry, I was still writing and testing my script then. Still investigating options for incorporating MFA. I spent this morning enabling MFA for my Admin account and documenting the process. Hopefully investigate MFA script soon.", "edited": false, "downs": 0, "body_html": "&lt;div class=\"md\"&gt;&lt;p&gt;Sorry, I was still writing and testing my script then. Still investigating options for incorporating MFA. I spent this morning enabling MFA for my Admin account and documenting the process. Hopefully investigate MFA script soon.&lt;/p&gt;\n&lt;/div&gt;", "subreddit": "sysadmin", "name": "t1_dgbrofa", "score_hidden": false, "stickied": false, "created": 1492351953.0, "created_utc": 1492323153.0, "depth": 3, "mod_reports": [], "subreddit_type": "public", "ups": 1}}], "after": null, "before": null}}, "user_reports": [], "id": "dgbav92", "gilded": 0, "archived": false, "score": 1, "report_reasons": null, "author": "feckinarse", "parent_id": "t1_dgawvyn", "subreddit_name_prefixed": "r/sysadmin", "controversiality": 0, "body": "Where was this post 2 days ago when I was trying to badly script user removal from 365! Ended up finding the same code you have on a random Chinese blog.\n\nThanks though, this should help lots of people. I wonder why they made it so obscure.", "edited": false, "downs": 0, "body_html": "&lt;div class=\"md\"&gt;&lt;p&gt;Where was this post 2 days ago when I was trying to badly script user removal from 365! Ended up finding the same code you have on a random Chinese blog.&lt;/p&gt;\n\n&lt;p&gt;Thanks though, this should help lots of people. I wonder why they made it so obscure.&lt;/p&gt;\n&lt;/div&gt;", "subreddit": "sysadmin", "name": "t1_dgbav92", "score_hidden": false, "stickied": false, "created": 1492325576.0, "created_utc": 1492296776.0, "depth": 2, "mod_reports": [], "subreddit_type": "public", "ups": 1}}, {"kind": "t1", "data": {"subreddit_id": "t5_2qnp7", "removal_reason": null, "link_id": "t3_65hmc4", "likes": null, "replies": {"kind": "Listing", "data": {"modhash": "", "children": [{"kind": "t1", "data": {"subreddit_id": "t5_2qnp7", "removal_reason": null, "link_id": "t3_65hmc4", "likes": null, "replies": {"kind": "Listing", "data": {"modhash": "", "children": [{"kind": "t1", "data": {"subreddit_id": "t5_2qnp7", "removal_reason": null, "link_id": "t3_65hmc4", "likes": null, "replies": {"kind": "Listing", "data": {"modhash": "", "children": [{"kind": "t1", "data": {"subreddit_id": "t5_2qnp7", "removal_reason": null, "link_id": "t3_65hmc4", "likes": null, "replies": {"kind": "Listing", "data": {"modhash": "", "children": [{"kind": "t1", "data": {"subreddit_id": "t5_2qnp7", "removal_reason": null, "link_id": "t3_65hmc4", "likes": null, "replies": {"kind": "Listing", "data": {"modhash": "", "children": [{"kind": "t1", "data": {"subreddit_id": "t5_2qnp7", "removal_reason": null, "link_id": "t3_65hmc4", "likes": null, "replies": {"kind": "Listing", "data": {"modhash": "", "children": [{"kind": "t1", "data": {"subreddit_id": "t5_2qnp7", "removal_reason": null, "link_id": "t3_65hmc4", "likes": null, "replies": {"kind": "Listing", "data": {"modhash": "", "children": [{"kind": "t1", "data": {"subreddit_id": "t5_2qnp7", "removal_reason": null, "link_id": "t3_65hmc4", "likes": null, "replies": "", "user_reports": [], "id": "dgd3a5z", "gilded": 0, "archived": false, "score": 1, "report_reasons": null, "author": "Wargala", "parent_id": "t1_dgd2o4y", "subreddit_name_prefixed": "r/sysadmin", "controversiality": 0, "body": "Excellent work!  It's nice to see people tackle problems that others may encounter, but Microsoft doesn't document well. :). Hope you had a good Easter!", "edited": false, "downs": 0, "body_html": "&lt;div class=\"md\"&gt;&lt;p&gt;Excellent work!  It&amp;#39;s nice to see people tackle problems that others may encounter, but Microsoft doesn&amp;#39;t document well. :). Hope you had a good Easter!&lt;/p&gt;\n&lt;/div&gt;", "subreddit": "sysadmin", "name": "t1_dgd3a5z", "score_hidden": false, "stickied": false, "created": 1492431064.0, "created_utc": 1492402264.0, "depth": 9, "mod_reports": [], "subreddit_type": "public", "ups": 1}}], "after": null, "before": null}}, "user_reports": [], "id": "dgd2o4y", "gilded": 0, "archived": false, "score": 1, "report_reasons": null, "author": "365Admin", "parent_id": "t1_dgcv6by", "subreddit_name_prefixed": "r/sysadmin", "controversiality": 0, "body": "OK... after MUCH effort and investigation, I have created v3.0 to support MFA on the four services that support PowerShell MFA and connection to the other services with a separate Admin account with no MFA.\n\nBest solution at this point, if you want MFA with PowerShell is to have two accounts. The MFA account can run PowerShell for the following four services -\n\n- Exchange Online MFA\n\n- Azure AD v1.0 MFA\n\n- Azure AD v2.0 MFA\n\n- SharePoint Online MFA\n\nThen you have a second account without MFA to handle PowerShell connections for the following services \n\n- Skype for Business Online\n\n- Compliance Center\n\n- Exchange Online Protection\n\n- Azure Resource Manager\n\nOf course it is a HUGE pain in the butt to have to enter credentials for each of the MFA services. That is the downside of the higher security.\n\nI have been investigating on restricting the secondary (non-MFA) Admin account to only those services, but there is very little documentation in regards to that.\n\nI will most likely update my blog to include a new post for configuring Admin accounts for MFA and provide a link to the updated Connection script for MFA. \n\nPersonally, I think it will probably be easier to just run the individual connection script for an MFA enabled account when administering that service. It gets real old, real quick, entering your credentials, your password and then the verification code four times, and then adding your non MFA account creds before you can even start administering.\n\n", "edited": false, "downs": 0, "body_html": "&lt;div class=\"md\"&gt;&lt;p&gt;OK... after MUCH effort and investigation, I have created v3.0 to support MFA on the four services that support PowerShell MFA and connection to the other services with a separate Admin account with no MFA.&lt;/p&gt;\n\n&lt;p&gt;Best solution at this point, if you want MFA with PowerShell is to have two accounts. The MFA account can run PowerShell for the following four services -&lt;/p&gt;\n\n&lt;ul&gt;\n&lt;li&gt;&lt;p&gt;Exchange Online MFA&lt;/p&gt;&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;Azure AD v1.0 MFA&lt;/p&gt;&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;Azure AD v2.0 MFA&lt;/p&gt;&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;SharePoint Online MFA&lt;/p&gt;&lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;p&gt;Then you have a second account without MFA to handle PowerShell connections for the following services &lt;/p&gt;\n\n&lt;ul&gt;\n&lt;li&gt;&lt;p&gt;Skype for Business Online&lt;/p&gt;&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;Compliance Center&lt;/p&gt;&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;Exchange Online Protection&lt;/p&gt;&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;Azure Resource Manager&lt;/p&gt;&lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;p&gt;Of course it is a HUGE pain in the butt to have to enter credentials for each of the MFA services. That is the downside of the higher security.&lt;/p&gt;\n\n&lt;p&gt;I have been investigating on restricting the secondary (non-MFA) Admin account to only those services, but there is very little documentation in regards to that.&lt;/p&gt;\n\n&lt;p&gt;I will most likely update my blog to include a new post for configuring Admin accounts for MFA and provide a link to the updated Connection script for MFA. &lt;/p&gt;\n\n&lt;p&gt;Personally, I think it will probably be easier to just run the individual connection script for an MFA enabled account when administering that service. It gets real old, real quick, entering your credentials, your password and then the verification code four times, and then adding your non MFA account creds before you can even start administering.&lt;/p&gt;\n&lt;/div&gt;", "subreddit": "sysadmin", "name": "t1_dgd2o4y", "score_hidden": false, "stickied": false, "created": 1492430068.0, "created_utc": 1492401268.0, "depth": 8, "mod_reports": [], "subreddit_type": "public", "ups": 1}}], "after": null, "before": null}}, "user_reports": [], "id": "dgcv6by", "gilded": 0, "archived": false, "score": 1, "report_reasons": null, "author": "Wargala", "parent_id": "t1_dgcjzex", "subreddit_name_prefixed": "r/sysadmin", "controversiality": 0, "body": "Do it!  :)", "edited": false, "downs": 0, "body_html": "&lt;div class=\"md\"&gt;&lt;p&gt;Do it!  :)&lt;/p&gt;\n&lt;/div&gt;", "subreddit": "sysadmin", "name": "t1_dgcv6by", "score_hidden": false, "stickied": false, "created": 1492419618.0, "created_utc": 1492390818.0, "depth": 7, "mod_reports": [], "subreddit_type": "public", "ups": 1}}], "after": null, "before": null}}, "user_reports": [], "id": "dgcjzex", "gilded": 0, "archived": false, "score": 1, "report_reasons": null, "author": "365Admin", "parent_id": "t1_dgc5f3a", "subreddit_name_prefixed": "r/sysadmin", "controversiality": 0, "body": "True... I will investigate further today, but from my research so far, if you implement MFA, you can't store credentials and it will prompt for logins four times. That is why I will probably look at three scripts, plus  all the individuals. One ZIP file to rule the world ?\n", "edited": false, "downs": 0, "body_html": "&lt;div class=\"md\"&gt;&lt;p&gt;True... I will investigate further today, but from my research so far, if you implement MFA, you can&amp;#39;t store credentials and it will prompt for logins four times. That is why I will probably look at three scripts, plus  all the individuals. One ZIP file to rule the world ?&lt;/p&gt;\n&lt;/div&gt;", "subreddit": "sysadmin", "name": "t1_dgcjzex", "score_hidden": false, "stickied": false, "created": 1492404575.0, "created_utc": 1492375775.0, "depth": 6, "mod_reports": [], "subreddit_type": "public", "ups": 1}}], "after": null, "before": null}}, "user_reports": [], "id": "dgc5f3a", "gilded": 0, "archived": false, "score": 1, "report_reasons": null, "author": "Wargala", "parent_id": "t1_dgbu5i2", "subreddit_name_prefixed": "r/sysadmin", "controversiality": 0, "body": "Hmm.   If that is true, then I would imagine a script like yours would prompt people multiple times.  I'll have to play with it in my office on Monday.  My in laws are down from Canada and it's the baby's first easter. :)", "edited": false, "downs": 0, "body_html": "&lt;div class=\"md\"&gt;&lt;p&gt;Hmm.   If that is true, then I would imagine a script like yours would prompt people multiple times.  I&amp;#39;ll have to play with it in my office on Monday.  My in laws are down from Canada and it&amp;#39;s the baby&amp;#39;s first easter. :)&lt;/p&gt;\n&lt;/div&gt;", "subreddit": "sysadmin", "name": "t1_dgc5f3a", "score_hidden": false, "stickied": false, "created": 1492385345.0, "created_utc": 1492356545.0, "depth": 5, "mod_reports": [], "subreddit_type": "public", "ups": 1}}], "after": null, "before": null}}, "user_reports": [], "id": "dgbu5i2", "gilded": 0, "archived": false, "score": 1, "report_reasons": null, "author": "365Admin", "parent_id": "t1_dgbshqc", "subreddit_name_prefixed": "r/sysadmin", "controversiality": 0, "body": "Hmmm... I have spent a while on this, and it looks like I can possibly create a script, but possibly one that prompts several times for the credentials, password and MFA.\n\nThis great post states - All of these above supports Azure MFA as long as you are not passing in a Credential object. There are also more advanced scenarios for programmatic access with Access Token and Certificates that I will not cover here for some of these modules. The main thing is that when you create a Credential object with Get-Credential, and pass that in as a Parameter to the above modules, Azure MFA will not work if the Admin user has been configured to use that. \n\nPost - https://gotoguy.blog/2016/09/09/how-to-enable-azure-mfa-for-online-powershell-modules-that-dont-support-mfa/\n", "edited": false, "downs": 0, "body_html": "&lt;div class=\"md\"&gt;&lt;p&gt;Hmmm... I have spent a while on this, and it looks like I can possibly create a script, but possibly one that prompts several times for the credentials, password and MFA.&lt;/p&gt;\n\n&lt;p&gt;This great post states - All of these above supports Azure MFA as long as you are not passing in a Credential object. There are also more advanced scenarios for programmatic access with Access Token and Certificates that I will not cover here for some of these modules. The main thing is that when you create a Credential object with Get-Credential, and pass that in as a Parameter to the above modules, Azure MFA will not work if the Admin user has been configured to use that. &lt;/p&gt;\n\n&lt;p&gt;Post - &lt;a href=\"https://gotoguy.blog/2016/09/09/how-to-enable-azure-mfa-for-online-powershell-modules-that-dont-support-mfa/\"&gt;https://gotoguy.blog/2016/09/09/how-to-enable-azure-mfa-for-online-powershell-modules-that-dont-support-mfa/&lt;/a&gt;&lt;/p&gt;\n&lt;/div&gt;", "subreddit": "sysadmin", "name": "t1_dgbu5i2", "score_hidden": false, "stickied": false, "created": 1492358511.0, "created_utc": 1492329711.0, "depth": 4, "mod_reports": [], "subreddit_type": "public", "ups": 1}}], "after": null, "before": null}}, "user_reports": [], "id": "dgbshqc", "gilded": 0, "archived": false, "score": 1, "report_reasons": null, "author": "Wargala", "parent_id": "t1_dgbsaim", "subreddit_name_prefixed": "r/sysadmin", "controversiality": 0, "body": "Hooray!  I shall take excellent care of my trillion internets! :)\n\nNo blog though, just my Github is my main \"online presence\".\n\nHowever, thank you very much for the credit!  I'll happily take some of that! :)\n\nHope you're having a good weekend!", "edited": false, "downs": 0, "body_html": "&lt;div class=\"md\"&gt;&lt;p&gt;Hooray!  I shall take excellent care of my trillion internets! :)&lt;/p&gt;\n\n&lt;p&gt;No blog though, just my Github is my main &amp;quot;online presence&amp;quot;.&lt;/p&gt;\n\n&lt;p&gt;However, thank you very much for the credit!  I&amp;#39;ll happily take some of that! :)&lt;/p&gt;\n\n&lt;p&gt;Hope you&amp;#39;re having a good weekend!&lt;/p&gt;\n&lt;/div&gt;", "subreddit": "sysadmin", "name": "t1_dgbshqc", "score_hidden": false, "stickied": false, "created": 1492353930.0, "created_utc": 1492325130.0, "depth": 3, "mod_reports": [], "subreddit_type": "public", "ups": 1}}], "after": null, "before": null}}, "user_reports": [], "id": "dgbsaim", "gilded": 0, "archived": false, "score": 1, "report_reasons": null, "author": "365Admin", "parent_id": "t1_dgawvyn", "subreddit_name_prefixed": "r/sysadmin", "controversiality": 0, "body": "ONE TRILLION INTERNETS FOR YOU MY FRIEND !!!!\nI used your code in my first script and it works a treat, even in PowerShell ISE.\nWith a little bit of luck, some string, and a jar of vaseline, I should be able to add the MFA component to my 'One Script to Rule the World'.\nI have already added your GitHub link to my references in my script. I will be creating a blog post later for all this, so let me know your Blog page and will add as credit.\nFYI - I found NOTHING on how to get the EXO MFA to work in PowerShell ISE. \nAwesome work !!!", "edited": false, "downs": 0, "body_html": "&lt;div class=\"md\"&gt;&lt;p&gt;ONE TRILLION INTERNETS FOR YOU MY FRIEND !!!!\nI used your code in my first script and it works a treat, even in PowerShell ISE.\nWith a little bit of luck, some string, and a jar of vaseline, I should be able to add the MFA component to my &amp;#39;One Script to Rule the World&amp;#39;.\nI have already added your GitHub link to my references in my script. I will be creating a blog post later for all this, so let me know your Blog page and will add as credit.\nFYI - I found NOTHING on how to get the EXO MFA to work in PowerShell ISE. \nAwesome work !!!&lt;/p&gt;\n&lt;/div&gt;", "subreddit": "sysadmin", "name": "t1_dgbsaim", "score_hidden": false, "stickied": false, "created": 1492353427.0, "created_utc": 1492324627.0, "depth": 2, "mod_reports": [], "subreddit_type": "public", "ups": 1}}, {"kind": "t1", "data": {"subreddit_id": "t5_2qnp7", "removal_reason": null, "link_id": "t3_65hmc4", "likes": null, "replies": {"kind": "Listing", "data": {"modhash": "", "children": [{"kind": "t1", "data": {"subreddit_id": "t5_2qnp7", "removal_reason": null, "link_id": "t3_65hmc4", "likes": null, "replies": "", "user_reports": [], "id": "dgbsgmm", "gilded": 0, "archived": false, "score": 1, "report_reasons": null, "author": "Wargala", "parent_id": "t1_dgbscl1", "subreddit_name_prefixed": "r/sysadmin", "controversiality": 0, "body": "Nice!  Excellent work! :)", "edited": false, "downs": 0, "body_html": "&lt;div class=\"md\"&gt;&lt;p&gt;Nice!  Excellent work! :)&lt;/p&gt;\n&lt;/div&gt;", "subreddit": "sysadmin", "name": "t1_dgbsgmm", "score_hidden": false, "stickied": false, "created": 1492353854.0, "created_utc": 1492325054.0, "depth": 3, "mod_reports": [], "subreddit_type": "public", "ups": 1}}], "after": null, "before": null}}, "user_reports": [], "id": "dgbscl1", "gilded": 0, "archived": false, "score": 1, "report_reasons": null, "author": "365Admin", "parent_id": "t1_dgawvyn", "subreddit_name_prefixed": "r/sysadmin", "controversiality": 0, "body": "BTW... I had your MFA component fail until I added\n\n-allow clobber\n\nUpdated MFA component -\n\nImport-Module $((Get-ChildItem -Path $($env:LOCALAPPDATA+\"\\Apps\\2.0\\\") -Filter Microsoft.Exchange.Management.ExoPowershellModule.dll -Recurse ).FullName|?{$_ -notmatch \"_none_\"}|select -First 1)\n$EXOSession = New-ExoPSSession\nImport-PSSession $EXOSession -AllowClobber", "edited": false, "downs": 0, "body_html": "&lt;div class=\"md\"&gt;&lt;p&gt;BTW... I had your MFA component fail until I added&lt;/p&gt;\n\n&lt;p&gt;-allow clobber&lt;/p&gt;\n\n&lt;p&gt;Updated MFA component -&lt;/p&gt;\n\n&lt;p&gt;Import-Module $((Get-ChildItem -Path $($env:LOCALAPPDATA+&amp;quot;\\Apps\\2.0\\&amp;quot;) -Filter Microsoft.Exchange.Management.ExoPowershellModule.dll -Recurse ).FullName|?{$_ -notmatch &amp;quot;&lt;em&gt;none&lt;/em&gt;&amp;quot;}|select -First 1)\n$EXOSession = New-ExoPSSession\nImport-PSSession $EXOSession -AllowClobber&lt;/p&gt;\n&lt;/div&gt;", "subreddit": "sysadmin", "name": "t1_dgbscl1", "score_hidden": false, "stickied": false, "created": 1492353573.0, "created_utc": 1492324773.0, "depth": 2, "mod_reports": [], "subreddit_type": "public", "ups": 1}}], "after": null, "before": null}}, "user_reports": [], "id": "dgawvyn", "gilded": 0, "archived": false, "score": 2, "report_reasons": null, "author": "Wargala", "parent_id": "t1_dgaebqf", "subreddit_name_prefixed": "r/sysadmin", "controversiality": 0, "body": "Here ya go buddy.\n\nhttps://github.com/Scine/Powershell/blob/master/Connect%20To%20Powershell%20with%20or%20without%202%20form%20factor%20auth%20enabled\n\nI had a hell of a time with 2FA, but put got it dialed in and put it on my Github repository.\n\n", "edited": false, "downs": 0, "body_html": "&lt;div class=\"md\"&gt;&lt;p&gt;Here ya go buddy.&lt;/p&gt;\n\n&lt;p&gt;&lt;a href=\"https://github.com/Scine/Powershell/blob/master/Connect%20To%20Powershell%20with%20or%20without%202%20form%20factor%20auth%20enabled\"&gt;https://github.com/Scine/Powershell/blob/master/Connect%20To%20Powershell%20with%20or%20without%202%20form%20factor%20auth%20enabled&lt;/a&gt;&lt;/p&gt;\n\n&lt;p&gt;I had a hell of a time with 2FA, but put got it dialed in and put it on my Github repository.&lt;/p&gt;\n&lt;/div&gt;", "subreddit": "sysadmin", "name": "t1_dgawvyn", "score_hidden": false, "stickied": false, "created": 1492306346.0, "created_utc": 1492277546.0, "depth": 1, "mod_reports": [], "subreddit_type": "public", "ups": 2}}], "after": null, "before": null}}, "user_reports": [], "id": "dgaebqf", "gilded": 0, "archived": false, "score": 3, "report_reasons": null, "author": "365Admin", "parent_id": "t3_65hmc4", "subreddit_name_prefixed": "r/sysadmin", "controversiality": 0, "body": "Correct.\nNothing for 2 Factor Authentication at this stage.\nI may look at updating in the future as it is something we are looking at for where I work.", "edited": false, "downs": 0, "body_html": "&lt;div class=\"md\"&gt;&lt;p&gt;Correct.\nNothing for 2 Factor Authentication at this stage.\nI may look at updating in the future as it is something we are looking at for where I work.&lt;/p&gt;\n&lt;/div&gt;", "subreddit": "sysadmin", "name": "t1_dgaebqf", "score_hidden": false, "stickied": false, "created": 1492267850.0, "created_utc": 1492239050.0, "depth": 0, "mod_reports": [], "subreddit_type": "public", "ups": 3}}, {"kind": "t1", "data": {"subreddit_id": "t5_2qnp7", "removal_reason": null, "link_id": "t3_65hmc4", "likes": null, "replies": "", "user_reports": [], "id": "dgafgi6", "gilded": 0, "archived": false, "score": 5, "report_reasons": null, "author": "365Admin", "parent_id": "t3_65hmc4", "subreddit_name_prefixed": "r/sysadmin", "controversiality": 0, "body": "Great article from Paul Cunningham - MVP - That discusses Admin accounts and Multi-Factor Auth.\nhttps://practical365.com/security/securing-office-365-administrator-accounts-multi-factor-authentication/\nAt the moment only four PowerShell connections support MFA.\n", "edited": false, "downs": 0, "body_html": "&lt;div class=\"md\"&gt;&lt;p&gt;Great article from Paul Cunningham - MVP - That discusses Admin accounts and Multi-Factor Auth.\n&lt;a href=\"https://practical365.com/security/securing-office-365-administrator-accounts-multi-factor-authentication/\"&gt;https://practical365.com/security/securing-office-365-administrator-accounts-multi-factor-authentication/&lt;/a&gt;\nAt the moment only four PowerShell connections support MFA.&lt;/p&gt;\n&lt;/div&gt;", "subreddit": "sysadmin", "name": "t1_dgafgi6", "score_hidden": false, "stickied": false, "created": 1492270782.0, "created_utc": 1492241982.0, "depth": 0, "mod_reports": [], "subreddit_type": "public", "ups": 5}}, {"kind": "t1", "data": {"subreddit_id": "t5_2qnp7", "removal_reason": null, "link_id": "t3_65hmc4", "likes": null, "replies": "", "user_reports": [], "id": "dgadyp4", "gilded": 0, "archived": false, "score": 3, "report_reasons": null, "author": "Wargala", "parent_id": "t3_65hmc4", "subreddit_name_prefixed": "r/sysadmin", "controversiality": 0, "body": "This doesn't appear to account for those of us who have 2 form factor authentication enabled, unless I'm missing something?\n", "edited": false, "downs": 0, "body_html": "&lt;div class=\"md\"&gt;&lt;p&gt;This doesn&amp;#39;t appear to account for those of us who have 2 form factor authentication enabled, unless I&amp;#39;m missing something?&lt;/p&gt;\n&lt;/div&gt;", "subreddit": "sysadmin", "name": "t1_dgadyp4", "score_hidden": false, "stickied": false, "created": 1492266968.0, "created_utc": 1492238168.0, "depth": 0, "mod_reports": [], "subreddit_type": "public", "ups": 3}}, {"kind": "t1", "data": {"subreddit_id": "t5_2qnp7", "removal_reason": null, "link_id": "t3_65hmc4", "likes": null, "replies": {"kind": "Listing", "data": {"modhash": "", "children": [{"kind": "t1", "data": {"subreddit_id": "t5_2qnp7", "removal_reason": null, "link_id": "t3_65hmc4", "likes": null, "replies": "", "user_reports": [], "id": "dgak26f", "gilded": 0, "archived": false, "score": 3, "report_reasons": null, "author": "365Admin", "parent_id": "t1_dgah8x7", "subreddit_name_prefixed": "r/sysadmin", "controversiality": 0, "body": "Thanks... It took a while to get all the information together !!!\nI agree, I think in the real world that most Orgs have dedicated cloud only Admin accounts, where hopefully the Admins have strong passwords. I am looking forward to a complete solution with MFA supporting all Cloud services.", "edited": false, "downs": 0, "body_html": "&lt;div class=\"md\"&gt;&lt;p&gt;Thanks... It took a while to get all the information together !!!\nI agree, I think in the real world that most Orgs have dedicated cloud only Admin accounts, where hopefully the Admins have strong passwords. I am looking forward to a complete solution with MFA supporting all Cloud services.&lt;/p&gt;\n&lt;/div&gt;", "subreddit": "sysadmin", "name": "t1_dgak26f", "score_hidden": false, "stickied": false, "created": 1492284889.0, "created_utc": 1492256089.0, "depth": 1, "mod_reports": [], "subreddit_type": "public", "ups": 3}}], "after": null, "before": null}}, "user_reports": [], "id": "dgah8x7", "gilded": 0, "archived": false, "score": 3, "report_reasons": null, "author": "RuleC", "parent_id": "t3_65hmc4", "subreddit_name_prefixed": "r/sysadmin", "controversiality": 0, "body": "Very useful script!\n\nIt is perplexing that MFA isn't yet supported by all PowerShell Office 365 connections.  We've resorted to having a dedicated admin account for each IT admin, separate from their primary account.  The UPN is obfuscated, so less 'guessable'. ", "edited": false, "downs": 0, "body_html": "&lt;div class=\"md\"&gt;&lt;p&gt;Very useful script!&lt;/p&gt;\n\n&lt;p&gt;It is perplexing that MFA isn&amp;#39;t yet supported by all PowerShell Office 365 connections.  We&amp;#39;ve resorted to having a dedicated admin account for each IT admin, separate from their primary account.  The UPN is obfuscated, so less &amp;#39;guessable&amp;#39;. &lt;/p&gt;\n&lt;/div&gt;", "subreddit": "sysadmin", "name": "t1_dgah8x7", "score_hidden": false, "stickied": false, "created": 1492276117.0, "created_utc": 1492247317.0, "depth": 0, "mod_reports": [], "subreddit_type": "public", "ups": 3}}, {"kind": "t1", "data": {"subreddit_id": "t5_2qnp7", "removal_reason": null, "link_id": "t3_65hmc4", "likes": null, "replies": {"kind": "Listing", "data": {"modhash": "", "children": [{"kind": "t1", "data": {"subreddit_id": "t5_2qnp7", "removal_reason": null, "link_id": "t3_65hmc4", "likes": null, "replies": "", "user_reports": [], "id": "dgb6k1m", "gilded": 0, "archived": false, "score": 1, "report_reasons": null, "author": "365Admin", "parent_id": "t1_dgatqz1", "subreddit_name_prefixed": "r/sysadmin", "controversiality": 0, "body": "I already have a GitHub - https://github.com/TeamTerry\n\nI just haven't updated it yet.  :)", "edited": false, "downs": 0, "body_html": "&lt;div class=\"md\"&gt;&lt;p&gt;I already have a GitHub - &lt;a href=\"https://github.com/TeamTerry\"&gt;https://github.com/TeamTerry&lt;/a&gt;&lt;/p&gt;\n\n&lt;p&gt;I just haven&amp;#39;t updated it yet.  :)&lt;/p&gt;\n&lt;/div&gt;", "subreddit": "sysadmin", "name": "t1_dgb6k1m", "score_hidden": false, "stickied": false, "created": 1492319485.0, "created_utc": 1492290685.0, "depth": 1, "mod_reports": [], "subreddit_type": "public", "ups": 1}}], "after": null, "before": null}}, "user_reports": [], "id": "dgatqz1", "gilded": 0, "archived": false, "score": 3, "report_reasons": null, "author": "lenswipe", "parent_id": "t3_65hmc4", "subreddit_name_prefixed": "r/sysadmin", "controversiality": 0, "body": "Ever consider posting this on GitHub?", "edited": false, "downs": 0, "body_html": "&lt;div class=\"md\"&gt;&lt;p&gt;Ever consider posting this on GitHub?&lt;/p&gt;\n&lt;/div&gt;", "subreddit": "sysadmin", "name": "t1_dgatqz1", "score_hidden": false, "stickied": false, "created": 1492302004.0, "created_utc": 1492273204.0, "depth": 0, "mod_reports": [], "subreddit_type": "public", "ups": 3}}, {"kind": "t1", "data": {"subreddit_id": "t5_2qnp7", "removal_reason": null, "link_id": "t3_65hmc4", "likes": null, "replies": "", "user_reports": [], "id": "dgad40b", "gilded": 0, "archived": false, "score": 1, "report_reasons": null, "author": "da_kink", "parent_id": "t3_65hmc4", "subreddit_name_prefixed": "r/sysadmin", "controversiality": 0, "body": "Cool, Thanks! ", "edited": false, "downs": 0, "body_html": "&lt;div class=\"md\"&gt;&lt;p&gt;Cool, Thanks! &lt;/p&gt;\n&lt;/div&gt;", "subreddit": "sysadmin", "name": "t1_dgad40b", "score_hidden": false, "stickied": false, "created": 1492265056.0, "created_utc": 1492236256.0, "depth": 0, "mod_reports": [], "subreddit_type": "public", "ups": 1}}, {"kind": "t1", "data": {"subreddit_id": "t5_2qnp7", "removal_reason": null, "link_id": "t3_65hmc4", "likes": null, "replies": "", "user_reports": [], "id": "dgarsw8", "gilded": 0, "archived": false, "score": 1, "report_reasons": null, "author": "Cuddels", "parent_id": "t3_65hmc4", "subreddit_name_prefixed": "r/sysadmin", "controversiality": 0, "body": "Bravo!", "edited": false, "downs": 0, "body_html": "&lt;div class=\"md\"&gt;&lt;p&gt;Bravo!&lt;/p&gt;\n&lt;/div&gt;", "subreddit": "sysadmin", "name": "t1_dgarsw8", "score_hidden": false, "stickied": false, "created": 1492299284.0, "created_utc": 1492270484.0, "depth": 0, "mod_reports": [], "subreddit_type": "public", "ups": 1}}, {"kind": "t1", "data": {"subreddit_id": "t5_2qnp7", "removal_reason": null, "link_id": "t3_65hmc4", "likes": null, "replies": "", "user_reports": [], "id": "dgavz82", "gilded": 0, "archived": false, "score": 1, "report_reasons": null, "author": "iwifia", "parent_id": "t3_65hmc4", "subreddit_name_prefixed": "r/sysadmin", "controversiality": 0, "body": "I like it, but does it connect to exchange online WITH MFA, which is a different login module ;D", "edited": false, "downs": 0, "body_html": "&lt;div class=\"md\"&gt;&lt;p&gt;I like it, but does it connect to exchange online WITH MFA, which is a different login module ;D&lt;/p&gt;\n&lt;/div&gt;", "subreddit": "sysadmin", "name": "t1_dgavz82", "score_hidden": false, "stickied": false, "created": 1492305117.0, "created_utc": 1492276317.0, "depth": 0, "mod_reports": [], "subreddit_type": "public", "ups": 1}}, {"kind": "t1", "data": {"subreddit_id": "t5_2qnp7", "removal_reason": null, "link_id": "t3_65hmc4", "likes": null, "replies": "", "user_reports": [], "id": "dgbrvr5", "gilded": 0, "archived": false, "score": 1, "report_reasons": null, "author": "365Admin", "parent_id": "t3_65hmc4", "subreddit_name_prefixed": "r/sysadmin", "controversiality": 0, "body": "Arrgghh !!!\nI create my scripts in PowerShell ISE, and going by this link, you can only run scripts in specific Exchange Online PowerShell. No idea at this point on how to have a single script look after the services AND support MFA.\n\n\nhttps://answers.microsoft.com/en-us/msoffice/forum/msoffice_o365admin-mso_exchon/powershell-connect-exopssession-and-ise-debugger/17df04f3-47df-4195-ad4f-06c648091897", "edited": false, "downs": 0, "body_html": "&lt;div class=\"md\"&gt;&lt;p&gt;Arrgghh !!!\nI create my scripts in PowerShell ISE, and going by this link, you can only run scripts in specific Exchange Online PowerShell. No idea at this point on how to have a single script look after the services AND support MFA.&lt;/p&gt;\n\n&lt;p&gt;&lt;a href=\"https://answers.microsoft.com/en-us/msoffice/forum/msoffice_o365admin-mso_exchon/powershell-connect-exopssession-and-ise-debugger/17df04f3-47df-4195-ad4f-06c648091897\"&gt;https://answers.microsoft.com/en-us/msoffice/forum/msoffice_o365admin-mso_exchon/powershell-connect-exopssession-and-ise-debugger/17df04f3-47df-4195-ad4f-06c648091897&lt;/a&gt;&lt;/p&gt;\n&lt;/div&gt;", "subreddit": "sysadmin", "name": "t1_dgbrvr5", "score_hidden": false, "stickied": false, "created": 1492352438.0, "created_utc": 1492323638.0, "depth": 0, "mod_reports": [], "subreddit_type": "public", "ups": 1}}], "after": null, "before": null}}]